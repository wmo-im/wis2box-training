---
title: إعداد مجموعات البيانات في wis2box
---

# إعداد مجموعات البيانات في wis2box

!!! abstract "نتائج التعلم"
    بنهاية هذه الجلسة العملية، ستكون قادرًا على:

    - استخدام محرر مجموعات البيانات في wis2box-webapp
    - إنشاء مجموعات بيانات جديدة باستخدام القالب =*weather/surface-based-observations/synop* والقالب =*other*
    - تعريف بيانات الاكتشاف الوصفية الخاصة بك
    - مراجعة تعيينات البيانات الخاصة بك
    - نشر إشعار WIS2 لبيانات الاكتشاف الوصفية الخاصة بك

## المقدمة

يستخدم wis2box **مجموعات البيانات** المرتبطة بـ **بيانات الاكتشاف الوصفية** و **تعيينات البيانات**.

تُستخدم **بيانات الاكتشاف الوصفية** لإنشاء سجل WCMP2 (WMO Core Metadata Profile 2) يتم مشاركته باستخدام إشعار WIS2 يتم نشره على wis2box-broker الخاص بك.

تُستخدم **تعيينات البيانات** لربط المكونات الإضافية للبيانات ببيانات الإدخال الخاصة بك، مما يسمح بتحويل بياناتك قبل نشرها على WIS2.

في هذه الجلسة العملية، ستتعلم كيفية إنشاء وتكوين مجموعات البيانات باستخدام **محرر مجموعات البيانات في wis2box-webapp**.

!!! note "إعداد مجموعات البيانات بدون استخدام wis2box-webapp"

    يدعم wis2box أيضًا إعداد مجموعات البيانات باستخدام [ملف التحكم بالبيانات الوصفية (MCF)](https://geopython.github.io/pygeometa/reference/mcf).

    يتيح استخدام MCF مزيدًا من المرونة والتحكم ولكنه قد يكون أكثر عرضة للأخطاء حيث تحتاج إلى التأكد من أن MCF مُنسق بشكل صحيح ويتوافق مع المخطط المطلوب.

    يمكن نشر ملفات MCF من سطر الأوامر في حاوية wis2box-management. راجع [وثائق wis2box](https://docs.wis2box.wis.wmo.int/en/latest/reference/running/discovery-metadata.html) لمزيد من المعلومات.

## التحضير

اتصل بالوسيط الخاص بك باستخدام MQTT Explorer.

بدلاً من استخدام بيانات اعتماد الوسيط الداخلي الخاص بك، استخدم بيانات الاعتماد العامة `everyone/everyone`:

<img alt="MQTT Explorer: الاتصال بالوسيط" src="/../assets/img/mqtt-explorer-wis2box-broker-everyone-everyone.png" width="800">

!!! Note

    لا تحتاج أبدًا إلى مشاركة بيانات اعتماد الوسيط الداخلي الخاص بك مع المستخدمين الخارجيين. المستخدم 'everyone' هو مستخدم عام لتمكين مشاركة إشعارات WIS2.

    بيانات الاعتماد `everyone/everyone` لديها وصول للقراءة فقط على الموضوع 'origin/a/wis2/#'. هذا هو الموضوع الذي يتم فيه نشر إشعارات WIS2. يمكن للـ Global Broker الاشتراك باستخدام بيانات الاعتماد العامة هذه لتلقي الإشعارات.

    لن يتمكن المستخدم 'everyone' من رؤية المواضيع الداخلية أو نشر الرسائل.

افتح متصفحًا وانتقل إلى `http://YOUR-HOST/wis2box-webapp`. تأكد من أنك قمت بتسجيل الدخول ويمكنك الوصول إلى صفحة 'محرر مجموعات البيانات'.

راجع القسم الخاص بـ [تهيئة wis2box](./initializing-wis2box.md) إذا كنت بحاجة إلى تذكر كيفية الاتصال بالوسيط أو الوصول إلى wis2box-webapp.

## إنشاء رمز تفويض لـ processes/wis2box

ستحتاج إلى رمز تفويض لنقطة النهاية 'processes/wis2box' لنشر مجموعة البيانات الخاصة بك.

لإنشاء رمز تفويض، قم بالوصول إلى جهاز التدريب الافتراضي الخاص بك عبر SSH واستخدم الأوامر التالية:

```bash
cd ~/wis2box
python3 wis2box-ctl.py login
```

ثم قم بتشغيل الأمر التالي لإنشاء رمز تفويض عشوائي لنقطة النهاية 'processes/wis2box':

```bash
wis2box auth add-token --path processes/wis2box
```

يمكنك أيضًا إنشاء رمز بقيمة محددة عن طريق توفير الرمز كمعامل للأمر:

```bash
wis2box auth add-token --path processes/wis2box MyS3cretToken
```

تأكد من نسخ قيمة الرمز وتخزينها على جهازك المحلي، حيث ستحتاج إليها لاحقًا.

بمجرد حصولك على الرمز، يمكنك الخروج من حاوية wis2box-management:

```bash
exit
```

## محرر مجموعات البيانات في wis2box-webapp

انتقل إلى صفحة 'محرر مجموعات البيانات' في wis2box-webapp الخاص بمثيل wis2box الخاص بك عن طريق الذهاب إلى `http://YOUR-HOST/wis2box-webapp` واختيار 'محرر مجموعات البيانات' من القائمة على الجانب الأيسر.

في صفحة 'محرر مجموعات البيانات'، ضمن علامة التبويب 'Datasets'، انقر على "Create New ...":

<img alt="إنشاء مجموعة بيانات جديدة" src="/../assets/img/wis2box-create-new-dataset.png" width="800">

ستظهر نافذة منبثقة تطلب منك تقديم:

- **Centre ID**: هذا هو اختصار الوكالة (بحروف صغيرة وبدون مسافات)، كما هو محدد من قبل عضو WMO، الذي يحدد مركز البيانات المسؤول عن نشر البيانات.
- **Template**: نوع البيانات التي تقوم بإنشاء بيانات وصفية لها. يمكنك الاختيار بين استخدام قالب محدد مسبقًا أو اختيار *other*.

<img alt="نافذة إنشاء مجموعة بيانات جديدة" src="/../assets/img/wis2box-create-new-dataset-pop-up.png" width="600">

!!! Note "Centre ID"

    يجب أن يبدأ Centre ID الخاص بك بـ TLD لبلدك، متبوعًا بشرطة (`-`) واسم مختصر لمنظمتك (على سبيل المثال `fr-meteofrance`). يجب أن يكون Centre ID بأحرف صغيرة ويستخدم أحرفًا أبجدية رقمية فقط. تعرض القائمة المنسدلة جميع معرفات المراكز المسجلة حاليًا على WIS2 بالإضافة إلى أي معرف مركز قمت بإنشائه بالفعل في wis2box. يرجى اختيار Centre ID مناسب لمنظمتك.

!!! Note "Template"

    يتيح لك حقل *Template* الاختيار من قائمة القوالب المتاحة في محرر مجموعات البيانات في wis2box-webapp. سيقوم القالب بملء النموذج بقيم افتراضية مقترحة مناسبة لنوع البيانات. يتضمن ذلك عنوانًا مقترحًا وكلمات مفتاحية للبيانات الوصفية ومكونات بيانات إضافية مهيأة مسبقًا.

    يتم تعيين الموضوع تلقائيًا إلى الموضوع الافتراضي المرتبط بالقالب المحدد ما لم تختر *other*. إذا اخترت *other*، يمكن تعريف الموضوع من قائمة منسدلة بناءً على [التسلسل الهرمي لموضوعات WIS2](https://codes.wmo.int/wis/topic-hierarchy/_earth-system-discipline).

لغرض التدريب، ستقوم بإنشاء مجموعتي بيانات:

- مجموعة بيانات باستخدام القالب =*weather/surface-based-observations/synop*، والتي تتضمن مكونات إضافية لتحويل البيانات إلى تنسيق BUFR قبل النشر.
- مجموعة بيانات باستخدام القالب =*other*، حيث تكون مسؤولاً عن تعريف موضوع WIS2 وستستخدم المكون الإضافي "Universal" لنشر البيانات دون تحويل.

## القالب =weather/surface-based-observations/synop

بالنسبة لـ **Template**، اختر **weather/surface-based-observations/synop**:

<img alt="نموذج إنشاء مجموعة بيانات: المعلومات الأولية" src="/../assets/img/wis2box-create-new-dataset-form-initial.png" width="450">

انقر على *continue to form* للمتابعة. ستظهر لك الآن **نموذج محرر مجموعة البيانات**.

نظرًا لأنك اخترت القالب **weather/surface-based-observations/synop**، سيتم ملء النموذج مسبقًا ببعض القيم الأولية المتعلقة بهذا النوع من البيانات.

### إنشاء بيانات الاكتشاف الوصفية

يتيح لك نموذج محرر مجموعة البيانات تقديم بيانات الاكتشاف الوصفية لمجموعة البيانات الخاصة بك والتي ستستخدمها حاوية wis2box-management لنشر سجل WCMP2.

نظرًا لأنك اخترت القالب 'weather/surface-based-observations/synop'، سيتم ملء النموذج مسبقًا بقيم افتراضية.

يرجى التأكد من استبدال 'Local ID' الذي تم إنشاؤه تلقائيًا باسم وصفي لمجموعة البيانات الخاصة بك، مثل 'synop-dataset-wis2training':

<img alt="محرر البيانات الوصفية: العنوان، الوصف، الكلمات المفتاحية" src="/../assets/img/wis2box-metadata-editor-part1.png" width="800">

راجع العنوان والكلمات المفتاحية، وقم بتحديثها حسب الحاجة، وقدم وصفًا لمجموعة البيانات الخاصة بك.

لاحظ أن هناك خيارات لتغيير 'سياسة بيانات WMO' من 'core' إلى 'recommended' أو لتعديل معرف البيانات الوصفية الافتراضي. يرجى الاحتفاظ بسياسة البيانات كـ 'core' واستخدام معرف البيانات الوصفية الافتراضي.

بعد ذلك، راجع القسم الذي يحدد 'الخصائص الزمنية' و'الخصائص المكانية'. يمكنك ضبط المربع المحيط عن طريق تحديث الحقول 'خط العرض الشمالي'، 'خط العرض الجنوبي'، 'خط الطول الشرقي'، و'خط الطول الغربي':

<img alt="محرر البيانات الوصفية: الخصائص الزمنية، الخصائص المكانية" src="/../assets/img/wis2box-metadata-editor-part2.png" width="800">

بعد ذلك، املأ القسم الذي يحدد 'معلومات الاتصال بمزود البيانات':

<img alt="محرر البيانات الوصفية: معلومات الاتصال" src="/../assets/img/wis2box-metadata-editor-part3.png" width="800">

أخيرًا، املأ القسم الذي يحدد 'معلومات جودة البيانات':

بمجرد الانتهاء من ملء جميع الأقسام، انقر على 'VALIDATE FORM' وتحقق من وجود أي أخطاء في النموذج:

<img alt="محرر البيانات الوصفية: التحقق من الصحة" src="/../assets/img/wis2box-metadata-validation-error.png" width="800">

إذا كانت هناك أي أخطاء، قم بتصحيحها وانقر على 'VALIDATE FORM' مرة أخرى.

تأكد من عدم وجود أخطاء وأنك تحصل على نافذة منبثقة تشير إلى أن النموذج قد تم التحقق من صحته:

<img alt="محرر البيانات الوصفية: نجاح التحقق من الصحة" src="/../assets/img/wis2box-metadata-validation-success.png" width="800">

بعد ذلك، قبل تقديم مجموعة البيانات الخاصة بك، راجع تعيينات البيانات لمجموعة البيانات الخاصة بك.

### تكوين تعيينات البيانات

نظرًا لأنك استخدمت قالبًا لإنشاء مجموعة البيانات الخاصة بك، فقد تم ملء تعيينات مجموعة البيانات مسبقًا بالمكونات الإضافية الافتراضية للقالب 'weather/surface-based-observations/synop'. تُستخدم المكونات الإضافية للبيانات في wis2box لتحويل البيانات قبل نشرها باستخدام إشعار WIS2.

<img alt="Data Mappings: update plugin" src="/../assets/img/wis2box-data-mappings.png" width="800">

لاحظ أنه يمكنك النقر على زر "Update" لتغيير إعدادات الإضافة مثل امتداد الملف ونمط الملف. يمكنك ترك الإعدادات الافتراضية في الوقت الحالي.

### إرسال مجموعة البيانات الخاصة بك

أخيرًا، يمكنك النقر على 'submit' لنشر مجموعة البيانات الخاصة بك.

ستحتاج إلى توفير رمز التفويض الخاص بـ 'processes/wis2box' الذي قمت بإنشائه سابقًا. إذا لم تقم بذلك، يمكنك إنشاء رمز جديد باتباع التعليمات في قسم التحضير.

تحقق من أنك تحصل على الرسالة التالية بعد إرسال مجموعة البيانات الخاصة بك، مما يشير إلى أنه تم إرسال مجموعة البيانات بنجاح:

<img alt="Submit Dataset Success" src="/../assets/img/wis2box-submit-dataset-success.png" width="400">

بعد النقر على 'OK'، سيتم توجيهك إلى الصفحة الرئيسية لمحرر مجموعة البيانات. الآن إذا قمت بالنقر على علامة التبويب 'Dataset'، يجب أن ترى مجموعة البيانات الجديدة الخاصة بك مدرجة:

<img alt="Dataset Editor: new dataset" src="/../assets/img/wis2box-dataset-editor-new-dataset.png" width="800">

### مراجعة إشعار WIS2 لبيانات الاكتشاف الوصفية

انتقل إلى MQTT Explorer. إذا كنت متصلاً بالوسيط، يجب أن ترى إشعار WIS2 جديدًا منشورًا على الموضوع `origin/a/wis2/<your-centre-id>/metadata`:

<img alt="MQTT Explorer: WIS2 notification" src="/../assets/img/mqtt-explorer-wis2-notification-metadata.png" width="800">

قم بفحص محتوى إشعار WIS2 الذي قمت بنشره. يجب أن ترى JSON به هيكل يتوافق مع تنسيق رسالة إشعار WIS (WNM).

!!! question

    على أي موضوع يتم نشر إشعار WIS2؟

??? success "انقر لعرض الإجابة"

    يتم نشر إشعار WIS2 على الموضوع `origin/a/wis2/<your-centre-id>/metadata`.

!!! question
    
    حاول العثور على العنوان والوصف والكلمات المفتاحية التي قدمتها في بيانات الاكتشاف الوصفية في إشعار WIS2. هل يمكنك العثور عليها؟

??? success "انقر لعرض الإجابة"

    **العنوان والوصف والكلمات المفتاحية التي قدمتها في بيانات الاكتشاف الوصفية غير موجودة في حمولة إشعار WIS2!** 
    
    بدلاً من ذلك، حاول البحث عن الرابط القانوني في قسم "links" في إشعار WIS2:

    <img alt="WIS2 notification for metadata, links sections" src="/../assets/img/wis2-notification-metadata-links.png" width="800">

    **يتضمن إشعار WIS2 رابطًا قانونيًا إلى سجل WCMP2 الذي تم نشره.** 
    
    انسخ هذا الرابط القانوني والصقه في متصفحك للوصول إلى سجل WCMP2. بناءً على إعدادات متصفحك، قد يُطلب منك تنزيل الملف أو قد يتم عرضه مباشرة في المتصفح.

    ستجد العنوان والوصف والكلمات المفتاحية التي قدمتها داخل سجل WCMP2.

يوفر wis2box عددًا محدودًا فقط من القوالب المعرفة مسبقًا. تم تصميم هذه القوالب لأنواع شائعة من مجموعات البيانات، ولكنها قد لا تتطابق دائمًا مع البيانات المتخصصة. بالنسبة لجميع الأنواع الأخرى من مجموعات البيانات، يمكنك إنشاء مجموعة البيانات الخاصة بك عن طريق اختيار Template=*other*.

## Template=other

بعد ذلك، سنقوم بإنشاء مجموعة بيانات ثانية باستخدام Template=*other*.

انقر على "Create New ..." مرة أخرى لإنشاء مجموعة بيانات جديدة. استخدم نفس centre-id الذي استخدمته من قبل، يجب أن يكون متاحًا في القائمة المنسدلة. بالنسبة لـ **Template**، اختر **other**:

<img alt="Create New Dataset Form: Initial information" src="/../assets/img/wis2box-create-new-dataset-form-initial-other.png" width="450">

انقر على *continue to form* للمتابعة، ستظهر لك الآن **نموذج محرر مجموعة البيانات** مرة أخرى.

### إنشاء بيانات اكتشاف وصفية

قم بتوفير القيم الخاصة بك لحقلي 'Title' و 'Description' وتأكد من استبدال 'Local ID' الذي تم إنشاؤه تلقائيًا باسم وصفي لمجموعة البيانات الخاصة بك:

<img alt="Metadata Editor: title, description, keywords" src="/../assets/img/wis2box-metadata-editor-part1-other.png" width="800">

لاحظ أنه بما أنك اخترت Template=*other*، فإن الأمر متروك لك لتعريف تسلسل موضوع WIS2 باستخدام القوائم المنسدلة لـ 'Discipline' و 'Sub-Discipline'.

لهذا التمرين، يرجى اختيار موضوع Sub-Discipline "prediction/analysis/medium-range/deterministic/global":

<img alt="Metadata Editor: title, description, keywords" src="/../assets/img/wis2box-metadata-editor-part1-other-topic.png" width="800">

بما أنك استخدمت Template=*other*، لم يتم تعريف أي كلمات مفتاحية مسبقًا. تأكد من إضافة 3 كلمات مفتاحية على الأقل من اختيارك:

<img alt="Metadata Editor: title, description, keywords" src="/../assets/img/wis2box-metadata-editor-part1-other-2.png" width="800">

بعد ملء الحقول المطلوبة، قم بملء الأقسام المتبقية من النموذج، بما في ذلك 'Temporal Properties' و 'Spatial Properties' و 'Contact Information of the Data Provider' وتأكد من التحقق من صحة النموذج.

### تكوين تعيينات البيانات

عند استخدام Template=other، لا يتم توفير تعيينات بيانات افتراضية. نتيجة لذلك، سيكون محرر تعيينات مجموعة البيانات فارغًا ويجب على المستخدمين تكوين التعيينات وفقًا لمتطلباتهم الخاصة.

<img alt="Data Mappings: update plugin" src="/../assets/img/wis2box-data-mappings-other1.png" width="800">

انقر على "ADD A PLUGIN +" لإضافة إضافة بيانات إلى مجموعة البيانات الخاصة بك.

اختر الإضافة باسم **"Universal data without conversion"**. تم تصميم هذه الإضافة لنشر البيانات دون تطبيق أي تحويل.

عند إضافة هذه الإضافة، ستحتاج إلى تحديد **امتداد الملف** و **نمط الملف** (المحدد بواسطة تعبير عادي) الذي يتطابق مع نمط تسمية ملفات البيانات الخاصة بك. في حالة إضافة "Universal"، يتم استخدام نمط الملف أيضًا لتحديد خاصية "datetime" للبيانات.

!!! Note "استخراج datetime من اسم الملف"

    تفترض إضافة "Universal" أن المجموعة الأولى في التعبير العادي تتوافق مع datetime للبيانات.

    نمط الملف الافتراضي هو `^.*?_(\d{8}).*?\..*$` الذي يتطابق مع 8 أرقام مسبوقة بشرطة سفلية ومتبوعة بأي أحرف ونقطة قبل امتداد الملف. على سبيل المثال:

    - `mydata_20250101.txt` ستتطابق وتستخرج 25 يناير 2025 كخاصية datetime للبيانات
    - `mydata_2025010112.txt` لن تتطابق، حيث يوجد 10 أرقام بدلاً من 8
    - `mydata-20250101.txt` لن تتطابق، حيث توجد شرطة بدلاً من الشرطة السفلية قبل التاريخ

    عند استيعاب البيانات باستخدام إضافة "Universal"، إما أن تعيد تسمية ملفاتك لتتطابق مع الافتراضي أو تحديث نمط الملف مع التأكد من أن المجموعة الأولى في التعبير العادي تتوافق مع datetime.

احتفظ بالقيم الافتراضية لـ "File Name" في الوقت الحالي لأنها تتطابق مع البيانات التي ستقوم باستيعابها في الجلسة العملية التالية:

<img alt="Data Mappings: update plugin" src="/../assets/img/wis2box-data-mappings-other2.png" width="800">

انقر على "SAVE" لحفظ إعدادات الإضافة وتحقق من أنك ترى الآن الإضافة مدرجة في محرر تعيينات مجموعة البيانات:

<img alt="Data Mappings: update plugin" src="/../assets/img/wis2box-data-mappings-other3.png" width="800">

لاحظ أنه عند استيعاب البيانات، يجب أن يتطابق امتداد الملف ونمط الملف مع الإعدادات التي قدمتها هنا، وإلا فلن تتم معالجة البيانات وسيسجل حاوية wis2box-management رسائل خطأ.

### إرسال ومراجعة النتيجة

أخيرًا، قم بتوفير رمز التفويض الخاص بـ 'processes/wis2box' الذي قمت بإنشائه سابقًا وانقر على 'submit' لنشر مجموعة البيانات الخاصة بك.

بعد الإرسال الناجح، ستظهر مجموعة البيانات الجديدة الخاصة بك في علامة التبويب Dataset:

<img alt="Dataset Editor: new dataset" src="/../assets/img/wis2box-dataset-editor-new-dataset-other.png" width="800">

انتقل إلى MQTT Explorer، إذا كنت متصلاً بالوسيط الخاص بك، يجب أن ترى إشعار WIS2 جديدًا منشورًا على الموضوع `origin/a/wis2/<your-centre-id>/metadata`.

!!! question
    
    قم بزيارة واجهة المستخدم الخاصة بـ wis2box على `http://YOUR-HOST`.
    
    كم عدد مجموعات البيانات التي تراها مدرجة؟ كيف يمكنك عرض تسلسل موضوع WIS2 المستخدم لكل مجموعة بيانات وكيف يمكنك رؤية وصف كل مجموعة بيانات؟

??? success "انقر لعرض الإجابة"

    من خلال فتح واجهة المستخدم الخاصة بـ wis2box على `http://YOUR-HOST`، يجب أن ترى مجموعتين من البيانات مدرجتين مع تسلسل موضوع WIS2 الخاص بهما. لعرض وصف كل مجموعة بيانات، يمكنك النقر على "metadata" الذي سيعيد التوجيه إلى عنصر 'discovery-metadata' المقابل كما يتم تقديمه بواسطة wis2box-api.

!!! question

    حاول تحديث وصف مجموعة البيانات الأخيرة التي أنشأتها. بعد تحديث الوصف، هل ترى إشعار WIS2 جديدًا منشورًا على الموضوع `origin/a/wis2/<your-centre-id>/metadata`؟ ما الفرق بين الإشعار الجديد والسابق؟

??? success "انقر لعرض الإجابة"

    يجب أن ترى رسالة إشعار بيانات جديدة يتم إرسالها بعد تحديث مجموعة البيانات الخاصة بك على الموضوع `origin/a/wis2/<your-centre-id>/metadata`.
    
    في الرسالة، ستتغير قيمة *"rel": "canonical"* إلى *"rel": "update"*، مما يشير إلى أن البيانات التي تم نشرها سابقًا قد تم تعديلها. لعرض الوصف المحدث، انسخ والصق عنوان URL في متصفحك ويجب أن ترى الوصف المحدث.

!!! question

حاول تحديث التسلسل الهرمي للموضوع الخاص بآخر مجموعة بيانات قمت بإنشائها عن طريق تغيير الاختيار في "مواضيع التخصص الفرعي". هل ترى إشعار WIS2 جديدًا منشورًا على الموضوع `origin/a/wis2/<your-centre-id>/metadata`؟

??? success "انقر للكشف عن الإجابة"

    لا يمكنك تحديث التسلسل الهرمي للموضوع لمجموعة بيانات موجودة. يتم تعطيل حقل التسلسل الهرمي للموضوع في نموذج محرر مجموعة البيانات بعد إنشاء مجموعة البيانات. إذا كنت تريد استخدام تسلسل هرمي مختلف للموضوع، قم أولاً بحذف مجموعة البيانات الحالية ثم قم بإنشاء مجموعة بيانات جديدة بالتسلسل الهرمي المطلوب.

## الخلاصة

!!! success "تهانينا!"
    في هذه الجلسة العملية، تعلمت كيفية:

    - استخدام محرر مجموعة البيانات في wis2box-webapp
    - إنشاء مجموعات بيانات جديدة باستخدام القالب Template=*weather/surface-based-observations/synop* والقالب Template=*other*
    - تعريف بيانات الاكتشاف الوصفية الخاصة بك
    - مراجعة تعيينات البيانات الخاصة بك
    - نشر بيانات الاكتشاف الوصفية ومراجعة إشعار WIS2