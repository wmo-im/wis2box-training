---
title: إعداد مجموعات البيانات في wis2box
---

# إعداد مجموعات البيانات في wis2box

!!! abstract "نتائج التعلم"
    بنهاية هذه الجلسة العملية، ستكون قادرًا على:

    - استخدام محرر مجموعات البيانات في wis2box-webapp
    - إنشاء مجموعات بيانات جديدة باستخدام القالب Template=*weather/surface-based-observations/synop* والقالب Template=*other*
    - تعريف بيانات الاكتشاف الوصفية الخاصة بك
    - مراجعة تعيينات البيانات الخاصة بك
    - نشر إشعار WIS2 لبيانات الاكتشاف الوصفية الخاصة بك

## المقدمة

يستخدم wis2box مجموعات بيانات مرتبطة ببيانات اكتشاف وصفية وتعيينات بيانات.

تُستخدم بيانات الاكتشاف الوصفية لإنشاء سجل WCMP2 (WMO Core Metadata Profile 2) يتم مشاركته باستخدام إشعار WIS2 يتم نشره على wis2box-broker الخاص بك.

تُستخدم تعيينات البيانات لربط مكون إضافي للبيانات ببيانات الإدخال الخاصة بك، مما يسمح بتحويل بياناتك قبل نشرها باستخدام إشعار WIS2.

ستوجهك هذه الجلسة خلال إنشاء مجموعات بيانات جديدة باستخدام القالب الافتراضي والقالب المخصص الخاص بك، وإنشاء بيانات اكتشاف وصفية، وتكوين تعيينات البيانات. ستقوم بفحص مجموعات البيانات الخاصة بك في wis2box-api ومراجعة إشعار WIS2 لبيانات الاكتشاف الوصفية الخاصة بك.

## التحضير

اتصل بالوسيط الخاص بك باستخدام MQTT Explorer.

بدلاً من استخدام بيانات اعتماد الوسيط الداخلي الخاص بك، استخدم بيانات الاعتماد العامة `everyone/everyone`:

<img alt="MQTT Explorer: Connect to broker" src="/../assets/img/mqtt-explorer-wis2box-broker-everyone-everyone.png" width="800">

!!! Note

    لا تحتاج أبدًا إلى مشاركة بيانات اعتماد الوسيط الداخلي الخاص بك مع المستخدمين الخارجيين. المستخدم 'everyone' هو مستخدم عام لتمكين مشاركة إشعارات WIS2.

    بيانات الاعتماد `everyone/everyone` لديها وصول للقراءة فقط على الموضوع 'origin/a/wis2/#'. هذا هو الموضوع الذي يتم فيه نشر إشعارات WIS2. يمكن للـ Global Broker الاشتراك باستخدام بيانات الاعتماد العامة هذه لتلقي الإشعارات.
    
    لن يتمكن المستخدم 'everyone' من رؤية المواضيع الداخلية أو نشر الرسائل.
    
افتح متصفحًا وانتقل إلى `http://YOUR-HOST/wis2box-webapp`. تأكد من تسجيل الدخول وأنك تستطيع الوصول إلى صفحة 'محرر مجموعة البيانات'.

راجع القسم [Initializing wis2box](./initializing-wis2box.md) إذا كنت بحاجة إلى تذكر كيفية الاتصال بالوسيط أو الوصول إلى wis2box-webapp.

## إنشاء رمز تفويض لـ processes/wis2box

ستحتاج إلى رمز تفويض لنقطة النهاية 'processes/wis2box' لنشر مجموعة البيانات الخاصة بك.

لإنشاء رمز تفويض، قم بالوصول إلى جهاز التدريب الخاص بك عبر SSH واستخدم الأوامر التالية:

```bash
cd ~/wis2box
python3 wis2box-ctl.py login
```

ثم قم بتشغيل الأمر التالي لإنشاء رمز تفويض عشوائي لنقطة النهاية 'processes/wis2box':

```bash
wis2box auth add-token --path processes/wis2box
```

يمكنك أيضًا إنشاء رمز بقيمة محددة عن طريق تقديم الرمز كوسيطة للأمر:

```bash
wis2box auth add-token --path processes/wis2box MyS3cretToken
```

تأكد من نسخ قيمة الرمز وتخزينها على جهازك المحلي، حيث ستحتاج إليها لاحقًا.

بمجرد حصولك على الرمز، يمكنك الخروج من حاوية wis2box-management:

```bash
exit
```

## محرر مجموعات البيانات في wis2box-webapp

انتقل إلى صفحة 'محرر مجموعة البيانات' في wis2box-webapp الخاص بمثيل wis2box الخاص بك عن طريق الذهاب إلى `http://YOUR-HOST/wis2box-webapp` واختيار 'dataset editor' من القائمة الموجودة على الجانب الأيسر.

في صفحة 'محرر مجموعة البيانات'، ضمن علامة التبويب 'Datasets'، انقر على "Create New ...":

<img alt="Create New Dataset" src="/../assets/img/wis2box-create-new-dataset.png" width="800">

ستظهر نافذة منبثقة تطلب منك تقديم:

- **Centre ID**: هذا هو اختصار الوكالة (بحروف صغيرة وبدون مسافات)، كما هو محدد من قبل عضو WMO، الذي يحدد مركز البيانات المسؤول عن نشر البيانات.
- **Template**: نوع البيانات التي تقوم بإنشاء بيانات وصفية لها. يمكنك الاختيار بين استخدام قالب محدد مسبقًا أو تحديد *other*.

<img alt="Create New Dataset pop up" src="/../assets/img/wis2box-create-new-dataset-pop-up.png" width="600">

!!! Note "Centre ID"

    يجب أن يبدأ Centre ID الخاص بك بنطاق المستوى الأعلى (TLD) لبلدك، متبوعًا بشرطة (`-`) واسم مختصر لمنظمتك (على سبيل المثال `fr-meteofrance`). يجب أن يكون Centre ID بأحرف صغيرة ويستخدم الأحرف الأبجدية الرقمية فقط. تعرض القائمة المنسدلة جميع معرفات المراكز المسجلة حاليًا في WIS2 بالإضافة إلى أي معرف مركز قمت بإنشائه بالفعل في wis2box. يرجى اختيار معرف مركز مناسب لمنظمتك.

!!! Note "Template"

    يتيح لك حقل *Template* الاختيار من قائمة القوالب المتوفرة في محرر مجموعات البيانات في wis2box-webapp. سيقوم القالب بملء النموذج مسبقًا بقيم افتراضية مقترحة مناسبة لنوع البيانات. يشمل ذلك العنوان المقترح والكلمات الرئيسية للبيانات الوصفية والمكونات الإضافية للبيانات المهيأة مسبقًا.
    
    يتم تعيين الموضوع تلقائيًا إلى الموضوع الافتراضي المرتبط بالقالب المحدد ما لم تختر *other*. إذا اخترت *other*، يمكن تعريف الموضوع من قائمة منسدلة بناءً على [WIS2 Topic Hierarchy](https://codes.wmo.int/wis/topic-hierarchy/_earth-system-discipline).

لأغراض التدريب، ستقوم بإنشاء مجموعتي بيانات:
    
- مجموعة بيانات باستخدام القالب Template=*weather/surface-based-observations/synop*، والتي تتضمن مكونات إضافية للبيانات تقوم بتحويل البيانات إلى تنسيق BUFR قبل النشر.
- مجموعة بيانات باستخدام القالب Template=*other*، حيث ستكون مسؤولاً عن تعريف موضوع WIS2 وستستخدم المكون الإضافي "Universal" لنشر البيانات دون تحويل.

## Template=weather/surface-based-observations/synop

بالنسبة إلى **Template**، اختر **weather/surface-based-observations/synop**:

<img alt="Create New Dataset Form: Initial information" src="/../assets/img/wis2box-create-new-dataset-form-initial.png" width="450">

انقر على *continue to form* للمتابعة. ستظهر لك الآن **نموذج محرر مجموعة البيانات**.

نظرًا لأنك اخترت القالب **weather/surface-based-observations/synop**، سيتم ملء النموذج مسبقًا ببعض القيم الأولية المتعلقة بهذا النوع من البيانات.

### إنشاء بيانات الاكتشاف الوصفية

يتيح لك نموذج محرر مجموعة البيانات تقديم بيانات الاكتشاف الوصفية لمجموعة البيانات الخاصة بك التي ستستخدمها حاوية wis2box-management لنشر سجل WCMP2.

نظرًا لأنك اخترت القالب 'weather/surface-based-observations/synop'، سيتم ملء النموذج مسبقًا ببعض القيم الافتراضية.

يرجى التأكد من استبدال 'Local ID' الذي تم إنشاؤه تلقائيًا باسم وصفي لمجموعة البيانات الخاصة بك، مثل 'synop-dataset-wis2training':

<img alt="Metadata Editor: title, description, keywords" src="/../assets/img/wis2box-metadata-editor-part1.png" width="800">

راجع العنوان والكلمات الرئيسية، وقم بتحديثها حسب الحاجة، وقدم وصفًا لمجموعة البيانات الخاصة بك.

لاحظ أن هناك خيارات لتغيير 'WMO Data Policy' من 'core' إلى 'recommended' أو لتعديل معرف البيانات الوصفية الافتراضي. يرجى الاحتفاظ بسياسة البيانات كـ 'core' واستخدام معرف البيانات الوصفية الافتراضي.

بعد ذلك، راجع القسم الذي يحدد 'الخصائص الزمنية' و'الخصائص المكانية'. يمكنك تعديل المربع المحيط عن طريق تحديث الحقول 'North Latitude' و'South Latitude' و'East Longitude' و'West Longitude':

<img alt="Metadata Editor: temporal properties, spatial properties" src="/../assets/img/wis2box-metadata-editor-part2.png" width="800">

بعد ذلك، املأ القسم الذي يحدد 'معلومات الاتصال بمزود البيانات':

<img alt="Metadata Editor: contact information" src="/../assets/img/wis2box-metadata-editor-part3.png" width="800">

أخيرًا، املأ القسم الذي يحدد 'معلومات جودة البيانات':

بمجرد الانتهاء من ملء جميع الأقسام، انقر على 'VALIDATE FORM' وتحقق من النموذج بحثًا عن أي أخطاء:

<img alt="Metadata Editor: validation" src="/../assets/img/wis2box-metadata-validation-error.png" width="800">

إذا كانت هناك أي أخطاء، قم بتصحيحها وانقر على 'VALIDATE FORM' مرة أخرى.

تأكد من عدم وجود أخطاء وأنك تحصل على نافذة منبثقة تشير إلى أنه تم التحقق من صحة النموذج:

<img alt="Metadata Editor: validation success" src="/../assets/img/wis2box-metadata-validation-success.png" width="800">

بعد ذلك، قبل تقديم مجموعة البيانات الخاصة بك، راجع تعيينات البيانات لمجموعة البيانات الخاصة بك.

### تكوين تعيينات البيانات

نظرًا لأنك استخدمت قالبًا لإنشاء مجموعة البيانات الخاصة بك، فقد تم ملء تعيينات مجموعة البيانات مسبقًا بالمكونات الإضافية الافتراضية للقالب 'weather/surface-based-observations/synop'. تُستخدم المكونات الإضافية للبيانات في wis2box لتحويل البيانات قبل نشرها باستخدام إشعار WIS2.

<img alt="Data Mappings: update plugin" src="/../assets/img/wis2box-data-mappings.png" width="800">

لاحظ أنه يمكنك النقر على زر "Update" لتغيير إعدادات المكون الإضافي مثل امتداد الملف ونمط الملف. يمكنك ترك الإعدادات الافتراضية في الوقت الحالي.

### تقديم مجموعة البيانات الخاصة بك

أخيرًا، يمكنك النقر على 'submit' لنشر مجموعة البيانات الخاصة بك.

ستحتاج إلى تقديم رمز التفويض لـ 'processes/wis2box' الذي قمت بإنشائه سابقًا. إذا لم تقم بذلك، يمكنك إنشاء رمز جديد باتباع التعليمات في قسم التحضير.

تحقق من أنك تحصل على الرسالة التالية بعد إرسال مجموعة البيانات الخاصة بك، مما يشير إلى أن مجموعة البيانات تم إرسالها بنجاح:

<img alt="Submit Dataset Success" src="/../assets/img/wis2box-submit-dataset-success.png" width="400">

بعد النقر على 'OK'، سيتم توجيهك إلى الصفحة الرئيسية لمحرر مجموعة البيانات. الآن إذا قمت بالنقر على علامة التبويب 'Dataset'، يجب أن ترى مجموعة البيانات الجديدة مدرجة:

<img alt="Dataset Editor: new dataset" src="/../assets/img/wis2box-dataset-editor-new-dataset.png" width="800">

### مراجعة إشعار WIS2 للبيانات الوصفية للاكتشاف

انتقل إلى MQTT Explorer. إذا كنت متصلاً بالـ broker، يجب أن ترى إشعار WIS2 جديد منشورًا على الموضوع `origin/a/wis2/<your-centre-id>/metadata`:

<img alt="MQTT Explorer: WIS2 notification" src="/../assets/img/mqtt-explorer-wis2-notification-metadata.png" width="800">

قم بفحص محتوى إشعار WIS2 الذي قمت بنشره. يجب أن ترى JSON به هيكل يتوافق مع تنسيق رسالة إشعار WIS (WNM).

!!! question

    على أي موضوع يتم نشر إشعار WIS2؟

??? success "Click to reveal answer"

    يتم نشر إشعار WIS2 على الموضوع `origin/a/wis2/<your-centre-id>/metadata`.

!!! question
    
    حاول العثور على العنوان والوصف والكلمات المفتاحية التي قدمتها في البيانات الوصفية للاكتشاف في إشعار WIS2. هل يمكنك العثور عليها؟

??? success "Click to reveal answer"

    **العنوان والوصف والكلمات المفتاحية التي قدمتها في البيانات الوصفية للاكتشاف غير موجودة في محتوى إشعار WIS2!** 
    
    بدلاً من ذلك، حاول البحث عن الرابط الأساسي في قسم "links" في إشعار WIS2:

    <img alt="WIS2 notification for metadata, links sections" src="/../assets/img/wis2-notification-metadata-links.png" width="800">

    **يتضمن إشعار WIS2 رابطًا أساسيًا إلى سجل WCMP2 الذي تم نشره.** 
    
    انسخ هذا الرابط الأساسي والصقه في متصفحك للوصول إلى سجل WCMP2. بناءً على إعدادات متصفحك، قد يُطلب منك تنزيل الملف أو قد يتم عرضه مباشرة في المتصفح.

    ستجد العنوان والوصف والكلمات المفتاحية التي قدمتها داخل سجل WCMP2.

يوفر wis2box عددًا محدودًا فقط من القوالب المعرفة مسبقًا. تم تصميم هذه القوالب لأنواع شائعة من مجموعات البيانات، لكنها قد لا تتطابق دائمًا مع البيانات المتخصصة. بالنسبة لجميع أنواع مجموعات البيانات الأخرى، يمكنك إنشاء مجموعة البيانات الخاصة بك عن طريق اختيار Template=*other*.

## Template=other

بعد ذلك، سنقوم بإنشاء مجموعة بيانات ثانية باستخدام Template=*other*.

انقر على "Create New ..." مرة أخرى لإنشاء مجموعة بيانات جديدة. استخدم نفس centre-id الذي استخدمته من قبل، يجب أن يكون متاحًا في القائمة المنسدلة. بالنسبة إلى **Template**، اختر **other**:

<img alt="Create New Dataset Form: Initial information" src="/../assets/img/wis2box-create-new-dataset-form-initial-other.png" width="450">

انقر على *continue to form* للمتابعة، ستظهر لك الآن **نموذج محرر مجموعة البيانات** مرة أخرى.

### إنشاء البيانات الوصفية للاكتشاف

قم بتوفير القيم الخاصة بك في حقول 'Title' و 'Description' وتأكد من استبدال 'Local ID' الذي تم إنشاؤه تلقائيًا باسم وصفي لمجموعة البيانات الخاصة بك:

<img alt="Metadata Editor: title, description, keywords" src="/../assets/img/wis2box-metadata-editor-part1-other.png" width="800">

لاحظ أنه بما أنك اخترت Template=*other*، فإنه يعود إليك تحديد تسلسل موضوع WIS2 باستخدام القوائم المنسدلة لـ 'Discipline' و 'Sub-Discipline'.

لهذا التمرين، يرجى اختيار موضوع Sub-Discipline "prediction/analysis/medium-range/deterministic/global":

<img alt="Metadata Editor: title, description, keywords" src="/../assets/img/wis2box-metadata-editor-part1-other-topic.png" width="800">

نظرًا لأنك استخدمت Template=*other*، لم يتم تعريف أي كلمات مفتاحية مسبقًا. تأكد من إضافة 3 كلمات مفتاحية على الأقل من اختيارك:

<img alt="Metadata Editor: title, description, keywords" src="/../assets/img/wis2box-metadata-editor-part1-other-2.png" width="800">

بعد ملء الحقول المطلوبة، أكمل ملء الأقسام المتبقية من النموذج، بما في ذلك 'Temporal Properties' و 'Spatial Properties' و 'Contact Information of the Data Provider' وتأكد من التحقق من صحة النموذج.

### تكوين تعيينات البيانات

عند استخدام قالب مخصص، لا يتم توفير تعيينات بيانات افتراضية. نتيجة لذلك، سيكون محرر تعيينات مجموعة البيانات فارغًا ويجب على المستخدمين تكوين التعيينات وفقًا لمتطلباتهم الخاصة.

<img alt="Data Mappings: update plugin" src="/../assets/img/wis2box-data-mappings-other1.png" width="800">

انقر على "ADD A PLUGIN +" لإضافة مكون إضافي للبيانات إلى مجموعة البيانات الخاصة بك.

اختر المكون الإضافي باسم **"Universal data without conversion"**. تم تصميم هذا المكون الإضافي لنشر البيانات دون تطبيق أي تحويل.

عند إضافة هذا المكون الإضافي، ستحتاج إلى تحديد **File Extension** ونمط **File Pattern** (يُعرّف بواسطة تعبير منتظم) الذي يتطابق مع نمط تسمية ملفات البيانات الخاصة بك. في حالة المكون الإضافي "Universal"، يتم استخدام نمط الملف أيضًا لتحديد خاصية "datetime" للبيانات.

!!! Note "Parsing datetime from filename"

    يفترض المكون الإضافي "Universal" أن المجموعة الأولى في التعبير المنتظم تتوافق مع التاريخ والوقت للبيانات.

    نمط الملف الافتراضي هو `^.*?_(\d{8}).*?\..*$` الذي يتطابق مع 8 أرقام مسبوقة بشرطة سفلية ومتبوعة بأي أحرف ونقطة قبل امتداد الملف. على سبيل المثال:

    - `mydata_20250101.txt` سيتطابق ويستخرج 25 يناير 2025 كخاصية datetime للبيانات
    - `mydata_2025010112.txt` لن يتطابق، حيث يوجد 10 أرقام بدلاً من 8
    - `mydata-20250101.txt` لن يتطابق، حيث توجد شرطة بدلاً من الشرطة السفلية قبل التاريخ

    عند إدخال البيانات باستخدام المكون الإضافي "Universal"، إما أن تعيد تسمية ملفاتك لتتطابق مع النمط الافتراضي أو تحدّث نمط الملف مع التأكد من أن المجموعة الأولى في التعبير المنتظم تتوافق مع التاريخ والوقت.

احتفظ بالقيم الافتراضية لـ "File Name" في الوقت الحالي لأنها تتطابق مع البيانات التي ستدخلها في الجلسة العملية التالية:

<img alt="Data Mappings: update plugin" src="/../assets/img/wis2box-data-mappings-other2.png" width="800">

انقر على "SAVE" لحفظ إعدادات المكون الإضافي وتحقق من أنك ترى الآن المكون الإضافي مدرجًا في محرر تعيينات مجموعة البيانات:

<img alt="Data Mappings: update plugin" src="/../assets/img/wis2box-data-mappings-other3.png" width="800">

لاحظ أنه عند إدخال البيانات، يجب أن يتطابق امتداد الملف ونمط الملف مع الإعدادات التي قدمتها هنا، وإلا لن تتم معالجة البيانات وسيسجل حاوية wis2box-management رسائل خطأ (ERROR).

### إرسال ومراجعة النتيجة

أخيرًا، قم بتوفير رمز التفويض لـ 'processes/wis2box' الذي أنشأته سابقًا وانقر على 'submit' لنشر مجموعة البيانات الخاصة بك.

بعد الإرسال الناجح، ستظهر مجموعة البيانات الجديدة في علامة التبويب Dataset:

<img alt="Dataset Editor: new dataset" src="/../assets/img/wis2box-dataset-editor-new-dataset-other.png" width="800">

انتقل إلى MQTT Explorer، إذا كنت متصلاً بالـ broker الخاص بك، يجب أن ترى إشعار WIS2 جديدًا منشورًا على الموضوع `origin/a/wis2/<your-centre-id>/metadata`.

!!! question
    
    قم بزيارة واجهة wis2box-UI على `http://YOUR-HOST`.
    
    كم عدد مجموعات البيانات التي تراها مدرجة؟ كيف يمكنك عرض تسلسل موضوع WIS2 المستخدم لكل مجموعة بيانات وكيف يمكنك رؤية وصف كل مجموعة بيانات؟

??? success "Click to reveal answer"

    من خلال فتح واجهة wis2box UI على `http://YOUR-HOST`، يجب أن ترى مجموعتي بيانات مدرجتين مع تسلسل موضوع WIS2 الخاص بهما. لرؤية وصف كل مجموعة بيانات، يمكنك النقر على "metadata" والتي ستعيد التوجيه إلى عنصر 'discovery-metadata' المقابل كما يتم تقديمه بواسطة wis2box-api.

!!! question

    حاول تحديث وصف مجموعة البيانات الأخيرة التي أنشأتها. بعد تحديث الوصف، هل ترى إشعار WIS2 جديدًا منشورًا على الموضوع `origin/a/wis2/<your-centre-id>/metadata`؟ ما الفرق بين الإشعار الجديد والسابق؟

??? success "Click to reveal answer"

    يجب أن ترى رسالة إشعار بيانات جديدة يتم إرسالها بعد تحديث مجموعة البيانات الخاصة بك على الموضوع `origin/a/wis2/<your-centre-id>/metadata`.
    
    في الرسالة، ستتغير قيمة *"rel": "canonical"* إلى *"rel": "update"*، مما يشير إلى أن البيانات التي تم نشرها سابقًا قد تم تعديلها. لعرض الوصف المحدث، انسخ والصق الرابط في متصفحك ويجب أن ترى الوصف المحدث.

!!! question

    حاول تحديث تسلسل الموضوع لمجموعة البيانات الأخيرة التي أنشأتها عن طريق تغيير الاختيار في "Sub-Discipline Topics". هل ترى إشعار WIS2 جديدًا منشورًا على الموضوع `origin/a/wis2/<your-centre-id>/metadata`؟

??? success "Click to reveal answer"

    لا يمكنك **تحديث تسلسل الموضوع لمجموعة بيانات موجودة.** حقل تسلسل الموضوع معطل في نموذج محرر مجموعة البيانات بعد إنشاء مجموعة البيانات. إذا كنت ترغب في استخدام تسلسل موضوع مختلف، قم أولاً بحذف مجموعة البيانات الحالية ثم قم بإنشاء مجموعة بيانات جديدة باستخدام تسلسل الموضوع المطلوب.

## الخلاصة

!!! success "تهانينا!"
    في هذه الجلسة العملية، تعلمت كيفية:

    - استخدام محرر مجموعات البيانات في `wis2box-webapp`
    - إنشاء مجموعات بيانات جديدة باستخدام القالب Template=*weather/surface-based-observations/synop* والقالب Template=*other*
    - تعريف بيانات الاكتشاف الوصفية الخاصة بك
    - مراجعة خرائط البيانات الخاصة بك
    - نشر بيانات الاكتشاف الوصفية ومراجعة إشعار WIS2