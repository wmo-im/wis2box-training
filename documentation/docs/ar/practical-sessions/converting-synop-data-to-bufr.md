---
title: تحويل بيانات SYNOP إلى BUFR
---

# تحويل بيانات SYNOP إلى BUFR من خلال سطر الأوامر

!!! abstract "نتائج التعلم"
    بنهاية هذه الجلسة العملية، ستكون قادرًا على:

    - استخدام أداة synop2bufr لتحويل تقارير SYNOP FM-12 إلى BUFR؛
    - تشخيص وإصلاح أخطاء الترميز البسيطة في تقارير SYNOP FM-12 قبل تحويل الصيغة؛

## مقدمة

تم تقديم تقارير الطقس السطحية من محطات السطح الأرضية تاريخيًا بشكل ساعي أو في الساعات الرئيسية
(00، 06، 12 و 18 بتوقيت UTC) والساعات الوسيطة (03، 09، 15، 21 بتوقيت UTC). قبل الانتقال
إلى BUFR، تم تشفير هذه التقارير في نموذج رمز SYNOP FM-12 النصي العادي. على الرغم من أن الانتقال إلى BUFR
كان من المقرر أن يكتمل بحلول عام 2012، لا يزال عدد كبير من التقارير يتم تبادلها بتنسيق SYNOP FM-12 القديم. يمكن العثور على مزيد من المعلومات حول تنسيق SYNOP FM-12 في الدليل اليدوي لـ WMO على الرموز،
المجلد الأول.1 (WMO-No. 306، المجلد الأول.1).

[دليل WMO على الرموز، المجلد الأول.1](https://library.wmo.int/records/item/35713-manual-on-codes-international-codes-volume-i-1)

للمساعدة في إكمال الانتقال إلى BUFR، تم تطوير بعض الأدوات ل
تشفير تقارير SYNOP FM-12 إلى BUFR، في هذه الجلسة ستتعلم كيفية استخدام هذه الأدوات بالإضافة
إلى العلاقة بين المعلومات الموجودة في تقارير SYNOP FM-12 ورسائل BUFR.

## التحضير

!!! warning "المتطلبات الأساسية"

    - تأكد من أن wis2box الخاص بك قد تم تكوينه وبدء تشغيله.
    - تأكد من الحالة بزيارة واجهة برمجة التطبيقات wis2box (``http://<اسم-المضيف>/oapi``) والتحقق من أن واجهة برمجة التطبيقات تعمل.
    - تأكد من قراءة أقسام **مقدمة synop2bufr** و**مقدمة ecCodes** قبل بدء التمارين.

## مقدمة synop2bufr

فيما يلي الأوامر والتكوينات الأساسية لـ `synop2bufr`:

### transform
تقوم وظيفة `transform` بتحويل رسالة SYNOP إلى BUFR:

```bash
synop2bufr data transform --metadata my_file.csv --output-dir ./my_directory --year message_year --month message_month my_SYNOP.txt
```

لاحظ أنه إذا لم يتم تحديد خيارات البيانات الوصفية، ودليل الإخراج، والسنة، والشهر، فسوف تفترض قيمها الافتراضية:

| الخيار      | الافتراضي |
| ----------- | ----------- |
| --metadata | station_list.csv |
| --output-dir | دليل العمل الحالي. |
| --year | السنة الحالية. |
| --month | الشهر الحالي. |

!!! note
    يجب أن تكون حذرًا عند استخدام السنة والشهر الافتراضيين، حيث قد لا يتطابق يوم الشهر المحدد في التقرير (على سبيل المثال، يونيو ليس لديه 31 يومًا).

في الأمثلة، لم يتم إعطاء السنة والشهر، لذا فلا تتردد في تحديد تاريخ بنفسك أو استخدام القيم الافتراضية.

## مقدمة ecCodes

يوفر ecCodes أدوات سطر الأوامر ويمكن دمجه في تطبيقاتك الخاصة. فيما يلي بعض الأدوات المفيدة لسطر الأوامر
للعمل مع بيانات BUFR.

### bufr_dump

أمر `bufr_dump` هو أداة معلومات BUFR عامة. لديها العديد من الخيارات، ولكن سيكون التالي هو الأكثر تطبيقًا على التمارين:

```bash
bufr_dump -p my_bufr.bufr4
```

سيعرض هذا محتوى BUFR على شاشتك. إذا كنت مهتمًا بالقيم التي تأخذها متغير معين، استخدم أمر `egrep`:

```bash
bufr_dump -p my_bufr.bufr4 | egrep -i temperature
```

سيعرض هذا المتغيرات المتعلقة بدرجة الحرارة في بيانات BUFR الخاصة بك. إذا كنت ترغب في القيام بذلك لأنواع متعددة من المتغيرات، قم بتصفية الإخراج باستخدام أنبوب (`|`):

```bash
bufr_dump -p my_bufr.bufr4 | egrep -i 'temperature|wind'
```

## تحويل SYNOP FM-12 إلى BUFR باستخدام synop2bufr من خلال سطر الأوامر

تم تثبيت مكتبة eccodes ووحدة synop2bufr في حاوية wis2box-api. من أجل القيام بالتمارين التالية، سنقوم بنسخ دليل تمارين synop2bufr إلى حاوية wis2box-api وتشغيل التمارين من هناك.

```bash
docker cp ~/exercise-materials/synop2bufr-exercises wis2box-api:/root
```

الآن يمكننا الدخول إلى الحاوية وتشغيل التمارين:

```bash
docker exec -it wis2box-api /bin/bash
```

### التمرين 1
انتقل إلى دليل `/root/synop2bufr-exercises/ex_1` وافحص ملف رسالة SYNOP message.txt:

```bash
cd /root/synop2bufr-exercises/ex_1
more message.txt
```

!!! question

    كم عدد تقارير SYNOP في هذا الملف؟

??? success "انقر لكشف الإجابة"
    
    يوجد تقرير SYNOP واحد، حيث يوجد محدد واحد (=) في نهاية الرسالة.

افحص قائمة المحطات:

```bash
more station_list.csv
```

!!! question

    كم عدد المحطات المدرجة في قائمة المحطات؟

??? success "انقر لكشف الإجابة"

    يوجد محطة واحدة، حيث يحتوي ملف station_list.csv على صف واحد من بيانات المحطة.

!!! question
    حاول تحويل `message.txt` إلى تنسيق BUFR.

??? success "انقر لكشف الإجابة"

    لتحويل رسالة SYNOP إلى تنسيق BUFR، استخدم الأمر التالي:

    ```bash
    synop2bufr data transform --metadata station_list.csv --output-dir ./ --year 2024 --month 09 message.txt
    ```

!!! tip

    انظر قسم [مقدمة synop2bufr](#مقدمة-synop2bufr).

افحص البيانات BUFR الناتجة باستخدام `bufr_dump`.

!!! question
     اكتشف كيفية مقارنة قيم خطوط العرض والطول بتلك الموجودة في قائمة المحطات.

??? success "انقر لكشف الإجابة"

    لمقارنة قيم خطوط العرض والطول في بيانات BUFR بتلك الموجودة في قائمة المحطات، استخدم الأمر التالي:

    ```bash
    bufr_dump -p WIGOS_0-20000-0-15015_20240921T120000.bufr4 | egrep -i 'latitude|longitude'
    ```

    سيعرض هذا قيم خطوط العرض والطول في بيانات BUFR.

!!! tip

    انظر قسم [مقدمة ecCodes](#مقدمة-eccodes).

### التمرين 2
انتقل إلى دليل `exercise-materials/synop2bufr-exercises/ex_2` وافحص ملف رسالة SYNOP message.txt:

```bash
cd /root/synop2bufr-exercises/ex_2
more message.txt
```

!!! question

    كم عدد تقارير SYNOP في هذا الملف؟

??? success "انقر لكشف الإجابة"

    يوجد 3 تقارير SYNOP، حيث يوجد 3 محددات (=) في نهاية الرسالة.

افحص قائمة المحطات:

```bash
more station_list.csv
```

!!! question

    كم عدد المحطات المدرجة في قائمة المحطات؟

??? success "انقر لكشف الإجابة"

    يوجد 3 محطات، حيث يحتوي ملف station_list.csv على ثلاثة صفوف من بيانات المحطة.

!!! question
    حول `message.txt` إلى تنسيق BUFR.

??? success "انقر لكشف الإجابة"

    لتحويل رسالة SYNOP إلى تنسيق BUFR، استخدم الأمر التالي:

    ```bash
    synop2bufr data transform --metadata station_list.csv --output-dir ./ --year 2024 --month 09 message.txt
    ```

!!! question

    استنادًا إلى نتائج التمارين في هذا التمرين والتمرين السابق، كيف يمكنك التنبؤ بعدد
    ملفات BUFR الناتجة بناءً على عدد تقارير SYNOP والمحطات المدرجة في ملف بيانات المحطة؟

??? success "انقر لكشف الإجابة"

    لرؤية ملفات BUFR المنتجة، قم بتشغيل الأمر التالي:

    ```bash
    ls -l *.bufr4
    ```

    سيكون عدد ملفات BUFR المنتجة مساويًا لعدد تقارير SYNOP في ملف الرسالة.

افحص البيانات BUFR الناتجة باستخدام `bufr_dump`.

!!! question
    كيف يمكنك التحقق من معرف محطة WIGOS المشفر داخل بيانات BUFR لكل ملف تم إنتاجه؟

??? success "انقر لكشف الإجابة"

    يمكن القيام بذلك باستخدام الأوامر التالية:

    ```bash
    bufr_dump -p WIGOS_0-20000-0-15015_20240921T120000.bufr4 | egrep -i 'wigos'
    ```

    ```bash
    bufr_dump -p WIGOS_0-20000-0-15020_20240921T120000.bufr4 | egrep -i 'wigos'
    ```

    ```bash
    bufr_dump -p WIGOS_0-20000-0-15090_20240921T120000.bufr4 | egrep -i 'wigos'
    ```

    لاحظ أنه إذا كان لديك دليل يحتوي فقط على هذه الملفات BUFR الثلاثة، يمكنك استخدام الأحرف البدلة في Linux على النحو التالي:

    ```bash
    bufr_dump -p *.bufr4 | egrep -i 'wigos'
    ```

### التمرين 3
انتقل إلى دليل `exercise-materials/synop2bufr-exercises/ex_3` وافحص ملف رسالة SYNOP message.txt:

```bash
cd /root/synop2bufr-exercises/ex_3
more message.txt
```

تحتوي هذه الرسالة SYNOP على تقرير واحد أطول مع المزيد من الأقسام.

افحص قائمة المحطات:

```bash
more station_list.csv
```

!!! question

    هل من المشكلة أن هذا الملف يحتوي على محطات أكثر مما تحتويه التقارير في رسالة SYNOP؟

??? success "انقر لكشف الإجابة"

    لا، هذه ليست مشكلة طالما أن هناك صفًا في ملف قائمة المحطات يحتوي على TSI للمحطة المطابقة لتقرير SYNOP الذي نحاول تحويله.

!!! note

    ملف قائمة المحطات هو مصدر للبيانات الوصفية لـ `synop2bufr` لتوفير المعلومات المفقودة في تقرير SYNOP الأبجدي الرقمي والمطلوبة في SYNOP BUFR.

!!! question
    حول `message.txt` إلى تنسيق BUFR.

??? success "انقر لكشف الإجابة"

    يتم ذلك باستخدام أمر `transform`، على سبيل المثال:

    ```bash
