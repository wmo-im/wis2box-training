
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="WIS2 in a box (wis2box) is a Free and Open Source (FOSS) Reference Implementation of a WMO WIS2 Node. The project provides a plug and play toolset to ingest, process, and publish weather/climate/water data using standards-based approaches in alignment with the WIS2 principles. wis2box also provides access to all data in the WIS2 network. wis2box is designed to have a low barrier to entry for data providers, providing enabling infrastructure and services for data discovery, access, and visualization.">
      
      
        <meta name="author" content="World Meteorological Organization">
      
      
        <link rel="canonical" href="https://training.wis2box.wis.wmo.int/zh/practical-sessions/data-conversion-tools/">
      
      
        <link rel="prev" href="../ingesting-data-for-publication/">
      
      
        <link rel="next" href="../csv2bufr-templates/">
      
      
        
          <link rel="alternate" href="../../../practical-sessions/data-conversion-tools/" hreflang="en">
        
          <link rel="alternate" href="../../../fr/practical-sessions/data-conversion-tools/" hreflang="fr">
        
          <link rel="alternate" href="../../../es/practical-sessions/data-conversion-tools/" hreflang="es">
        
          <link rel="alternate" href="./" hreflang="zh">
        
          <link rel="alternate" href="../../../ru/practical-sessions/data-conversion-tools/" hreflang="ru">
        
          <link rel="alternate" href="../../../ar/practical-sessions/data-conversion-tools/" hreflang="ar">
        
      
      
      <link rel="icon" href="https://public.wmo.int/sites/all/themes/wmo/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>数据转换工具 - WIS2 in a box training</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/css/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../" title="WIS2 in a box training" class="md-header__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../../../assets/img/wmo-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WIS2 in a box training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              数据转换工具
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="选择当前语言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../practical-sessions/data-conversion-tools/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../fr/practical-sessions/data-conversion-tools/" hreflang="fr" class="md-select__link">
              Français
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../es/practical-sessions/data-conversion-tools/" hreflang="es" class="md-select__link">
              Español
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../ru/practical-sessions/data-conversion-tools/" hreflang="ru" class="md-select__link">
              Русский
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../ar/practical-sessions/data-conversion-tools/" hreflang="ar" class="md-select__link">
              العربية
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="WIS2 in a box training" class="md-nav__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../../../assets/img/wmo-logo.png" alt="logo">

    </a>
    WIS2 in a box training
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    首页
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    csv2bufr 模板
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    csv2bufr 模板
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csv2bufr-templates/aws-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS 模板
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csv2bufr-templates/daycli-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DAYCLI 模板
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    备忘单
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    备忘单
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux 速查表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker 速查表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/wis2box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WIS2 盒装版速查表
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    实践课程
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    实践课程
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connecting-to-wis2-over-mqtt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    使用 MQTT 连接到 WIS2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accessing-your-student-vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    访问你的学生虚拟机
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../initializing-wis2box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    初始化 wis2box
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-wis2box-datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    在 wis2box 中配置数据集
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-station-metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    配置站点元数据
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ingesting-data-for-publication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    数据发布的摄取
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    数据转换工具
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    数据转换工具
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        介绍
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fm-12-synop" class="md-nav__link">
    <span class="md-ellipsis">
      
        关于 FM-12 SYNOP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eccodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        关于 ecCodes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csv2bufr-synop2bufr" class="md-nav__link">
    <span class="md-ellipsis">
      
        关于 csv2bufr 和 synop2bufr
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        准备工作
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eccodes_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        ecCodes 命令行工具
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ecCodes 命令行工具">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bufr_ls" class="md-nav__link">
    <span class="md-ellipsis">
      
        bufr_ls
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bufr_dump" class="md-nav__link">
    <span class="md-ellipsis">
      
        bufr_dump
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synop2bufr" class="md-nav__link">
    <span class="md-ellipsis">
      
        synop2bufr 转换
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="synop2bufr 转换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#synop" class="md-nav__link">
    <span class="md-ellipsis">
      
        查看示例 SYNOP 消息
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        查看站点列表
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synop-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      
        将 SYNOP 转换为 BUFR
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wis2box-webapp-synop" class="md-nav__link">
    <span class="md-ellipsis">
      
        wis2box-webapp 中的 SYNOP 表单
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csv2bufr" class="md-nav__link">
    <span class="md-ellipsis">
      
        csv2bufr 转换
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="csv2bufr 转换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#csv" class="md-nav__link">
    <span class="md-ellipsis">
      
        查看示例 CSV 文件
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-template" class="md-nav__link">
    <span class="md-ellipsis">
      
        查看 aws-template
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csv-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      
        将 CSV 转换为 BUFR
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        结论
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../csv2bufr-templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CSV至BUFR映射模板
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adding-gts-headers-to-wis2-notifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    为 WIS2 通知添加 GTS 头信息
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets-with-access-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    设置推荐数据集
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../downloading-data-from-wis2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    使用 wis2downloader 从 WIS2 下载数据
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../decoding-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    解码WMO二进制格式数据
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../discovering-datasets-from-wis2-gdc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    从 WIS2 全球发现目录中发现数据集
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        介绍
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fm-12-synop" class="md-nav__link">
    <span class="md-ellipsis">
      
        关于 FM-12 SYNOP
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eccodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        关于 ecCodes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csv2bufr-synop2bufr" class="md-nav__link">
    <span class="md-ellipsis">
      
        关于 csv2bufr 和 synop2bufr
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        准备工作
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eccodes_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        ecCodes 命令行工具
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ecCodes 命令行工具">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bufr_ls" class="md-nav__link">
    <span class="md-ellipsis">
      
        bufr_ls
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bufr_dump" class="md-nav__link">
    <span class="md-ellipsis">
      
        bufr_dump
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synop2bufr" class="md-nav__link">
    <span class="md-ellipsis">
      
        synop2bufr 转换
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="synop2bufr 转换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#synop" class="md-nav__link">
    <span class="md-ellipsis">
      
        查看示例 SYNOP 消息
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        查看站点列表
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synop-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      
        将 SYNOP 转换为 BUFR
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wis2box-webapp-synop" class="md-nav__link">
    <span class="md-ellipsis">
      
        wis2box-webapp 中的 SYNOP 表单
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csv2bufr" class="md-nav__link">
    <span class="md-ellipsis">
      
        csv2bufr 转换
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="csv2bufr 转换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#csv" class="md-nav__link">
    <span class="md-ellipsis">
      
        查看示例 CSV 文件
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-template" class="md-nav__link">
    <span class="md-ellipsis">
      
        查看 aws-template
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csv-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      
        将 CSV 转换为 BUFR
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        结论
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="_1">数据转换工具</h1>
<div class="admonition abstract">
<p class="admonition-title">学习目标</p>
<p>在本次实践课程结束时，您将能够：</p>
<ul>
<li>在 <code>wis2box-api</code> 容器中访问 ecCodes 命令行工具</li>
<li>使用 <code>synop2bufr</code> 工具从命令行将 FM-12 SYNOP 报告转换为 BUFR 格式</li>
<li>通过 <code>wis2box-webapp</code> 触发 <code>synop2bufr</code> 转换</li>
<li>使用 <code>csv2bufr</code> 工具从命令行将 CSV 数据转换为 BUFR 格式</li>
</ul>
</div>
<h2 id="_2">介绍</h2>
<p>在 WIS2 上发布的数据应符合由各地球系统学科/领域专家社区定义的要求和标准。为了降低发布陆地表面观测数据的门槛，<code>wis2box</code> 提供了将数据转换为 BUFR 格式的工具。这些工具可以通过 <code>wis2box-api</code> 容器使用，并可从命令行测试数据转换过程。</p>
<p>目前，<code>wis2box</code> 主要支持将 FM-12 SYNOP 报告转换为 BUFR，以及将 CSV 数据转换为 BUFR。支持 FM-12 数据是因为它在 WMO 社区中仍被广泛使用和交换，而支持 CSV 数据是为了将自动气象站生成的数据映射到 BUFR 格式。</p>
<h3 id="fm-12-synop">关于 FM-12 SYNOP</h3>
<p>陆地表面站的地面天气报告历史上通常每小时或在主要（00、06、12 和 18 UTC）和中间（03、09、15 和 21 UTC）时次进行报告。在迁移到 BUFR 之前，这些报告以纯文本的 FM-12 SYNOP 编码形式进行编码。尽管计划在 2012 年完成向 BUFR 的迁移，但仍有大量报告以传统的 FM-12 SYNOP 格式交换。有关 FM-12 SYNOP 格式的更多信息，请参阅《WMO 编码手册》，第一卷（WMO-No. 306, Volume I.1）。</p>
<h3 id="eccodes">关于 ecCodes</h3>
<p><code>ecCodes</code> 是一套用于解码和编码 GRIB 和 BUFR 格式气象数据的软件库和工具，由欧洲中期天气预报中心（ECMWF）开发。有关更多信息，请参阅 <a href="https://confluence.ecmwf.int/display/ECC/ecCodes+documentation">ecCodes 文档</a>。</p>
<p><code>wis2box</code> 软件在 <code>wis2box-api</code> 容器的基础镜像中包含了 <code>ecCodes</code> 库。这使用户能够从容器中访问命令行工具和库。在 <code>wis2box-stack</code> 中，<code>ecCodes</code> 库用于解码和编码 BUFR 消息。</p>
<h3 id="csv2bufr-synop2bufr">关于 csv2bufr 和 synop2bufr</h3>
<p>除了 <code>ecCodes</code>，<code>wis2box</code> 还使用以下与 <code>ecCodes</code> 配合的 Python 模块将数据转换为 BUFR 格式：</p>
<ul>
<li><strong>synop2bufr</strong>：支持传统上由人工观测员使用的 FM-12 SYNOP 格式。<code>synop2bufr</code> 模块依赖额外的站点元数据来在 BUFR 文件中编码额外的参数。请参阅 <a href="https://github.com/World-Meteorological-Organization/synop2bufr">GitHub 上的 synop2bufr 仓库</a>。</li>
<li><strong>csv2bufr</strong>：支持将自动气象站生成的 CSV 数据提取转换为 BUFR 格式。<code>csv2bufr</code> 模块使用映射模板将 CSV 数据映射到 BUFR 格式。请参阅 <a href="https://github.com/World-Meteorological-Organization/csv2bufr">GitHub 上的 csv2bufr 仓库</a>。</li>
</ul>
<p>这些模块可以单独使用，也可以作为 <code>wis2box</code> 堆栈的一部分使用。</p>
<h2 id="_3">准备工作</h2>
<div class="admonition warning">
<p class="admonition-title">前置条件</p>
<ul>
<li>确保您的 <code>wis2box</code> 已配置并启动</li>
<li>确保您已设置数据集并在 <code>wis2box</code> 中配置了至少一个站点</li>
<li>使用 <code>MQTT Explorer</code> 连接到 <code>wis2box</code> 实例的 MQTT broker</li>
<li>打开 <code>wis2box</code> Web 应用程序 (<code>http://YOUR-HOST/wis2box-webapp</code>) 并确保已登录</li>
<li>通过访问 <code>http://YOUR-HOST:3000</code> 打开实例的 Grafana 仪表板</li>
</ul>
</div>
<p>要使用 BUFR 命令行工具，您需要登录到 <code>wis2box-api</code> 容器。除非另有说明，所有命令应在此容器中运行。您还需要打开 <code>MQTT Explorer</code> 并连接到您的 broker。</p>
<p>首先，通过 SSH 客户端连接到您的学生虚拟机，并将练习材料复制到 <code>wis2box-api</code> 容器：</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>~/exercise-materials/data-conversion-exercises<span class="w"> </span>wis2box-api:/root
</code></pre></div>
<p>然后登录到 <code>wis2box-api</code> 容器并切换到练习材料所在的目录：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login<span class="w"> </span>wis2box-api
<span class="nb">cd</span><span class="w"> </span>/root/data-conversion-exercises
</code></pre></div>
<p>确认工具是否可用，从 <code>ecCodes</code> 开始：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-V
</code></pre></div>
<p>您应该会看到以下响应：</p>
<div class="highlight"><pre><span></span><code>ecCodes Version 2.36.0
</code></pre></div>
<p>接下来，检查 <code>synop2bufr</code> 版本：</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>--version
</code></pre></div>
<p>您应该会看到以下响应：</p>
<div class="highlight"><pre><span></span><code>synop2bufr, version 0.7.0
</code></pre></div>
<p>接下来，检查 <code>csv2bufr</code>：</p>
<div class="highlight"><pre><span></span><code>csv2bufr<span class="w"> </span>--version
</code></pre></div>
<p>您应该会看到以下响应：</p>
<div class="highlight"><pre><span></span><code>csv2bufr, version 0.8.6
</code></pre></div>
<h2 id="eccodes_1">ecCodes 命令行工具</h2>
<p><code>wis2box-api</code> 容器中包含的 <code>ecCodes</code> 库提供了许多用于处理 BUFR 文件的命令行工具。
接下来的练习将演示如何使用 <code>bufr_ls</code> 和 <code>bufr_dump</code> 检查 BUFR 文件的内容。</p>
<h3 id="bufr_ls">bufr_ls</h3>
<p>在第一个练习中，您将使用 <code>bufr_ls</code> 命令检查 BUFR 文件的头部，并确定文件内容的类型。</p>
<p>使用以下命令运行 <code>bufr_ls</code> 检查文件 <code>bufr-cli-ex1.bufr4</code>：</p>
<div class="highlight"><pre><span></span><code>bufr_ls<span class="w"> </span>bufr-cli-ex1.bufr4
</code></pre></div>
<p>您应该会看到以下输出：</p>
<div class="highlight"><pre><span></span><code>bufr-cli-ex1.bufr4
centre<span class="w">                     </span>masterTablesVersionNumber<span class="w">  </span>localTablesVersionNumber<span class="w">   </span>typicalDate<span class="w">                </span>typicalTime<span class="w">                </span>numberOfSubsets
cnmc<span class="w">                       </span><span class="m">29</span><span class="w">                         </span><span class="m">0</span><span class="w">                          </span><span class="m">20231002</span><span class="w">                   </span><span class="m">000000</span><span class="w">                     </span><span class="m">1</span>
<span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>messages<span class="w"> </span><span class="k">in</span><span class="w"> </span>bufr-cli-ex1.bufr4

<span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>total<span class="w"> </span>messages<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>file
</code></pre></div>
<p>可以通过向 <code>bufr_ls</code> 传递各种选项来更改输出的格式和打印的头部字段。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>如何以 JSON 格式列出上述输出？</p>
<p>您可以运行带有 <code>-h</code> 标志的 <code>bufr_ls</code> 命令查看可用选项。</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>您可以使用 <code>-j</code> 标志将输出格式更改为 JSON，例如：
<div class="highlight"><pre><span></span><code>bufr_ls<span class="w"> </span>-j<span class="w"> </span>bufr-cli-ex1.bufr4
</code></pre></div></p>
<p>运行后，您应该会看到以下输出：
<div class="highlight"><pre><span></span><code>{ &quot;messages&quot; : [
  {
    &quot;centre&quot;: &quot;cnmc&quot;,
    &quot;masterTablesVersionNumber&quot;: 29,
    &quot;localTablesVersionNumber&quot;: 0,
    &quot;typicalDate&quot;: 20231002,
    &quot;typicalTime&quot;: &quot;000000&quot;,
    &quot;numberOfSubsets&quot;: 1
  }
]}
</code></pre></div></p>
</details>
<p>打印的输出表示 BUFR 文件中某些头部键的值。</p>
<p>单独来看，这些信息并不十分有用，仅提供了文件内容的有限信息。</p>
<p>在检查 BUFR 文件时，我们通常希望确定文件中包含的数据类型以及数据的典型日期/时间。可以使用 <code>-p</code> 标志选择要输出的头部字段。多个头部字段可以使用逗号分隔的列表。</p>
<p>您可以使用以下命令列出数据类别、子类别、典型日期和时间：</p>
<div class="highlight"><pre><span></span><code>bufr_ls<span class="w"> </span>-p<span class="w"> </span>dataCategory,internationalDataSubCategory,typicalDate,typicalTime<span class="w"> </span>-j<span class="w"> </span>bufr-cli-ex1.bufr4
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>执行上述命令，并使用 <a href="https://github.com/wmo-im/CCT/blob/master/C13.csv">公共代码表 C-13</a> 解释输出以确定数据类别和子类别。</p>
<p>文件中包含的数据类型（数据类别和子类别）是什么？数据的典型日期和时间是什么？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<div class="highlight"><pre><span></span><code>{ &quot;messages&quot; : [
  {
    &quot;dataCategory&quot;: 2,
    &quot;internationalDataSubCategory&quot;: 4,
    &quot;typicalDate&quot;: 20231002,
    &quot;typicalTime&quot;: &quot;000000&quot;
  }
]}
</code></pre></div>
<p>从中可以看出：</p>
</details>
<ul>
<li>数据类别为 2，表示 <strong>“垂直探空（非卫星）”</strong> 数据。</li>
<li>国际子类别为 4，表示 <strong>“固定陆地站点的高空温度/湿度/风报告（TEMP）”</strong> 数据。</li>
<li>典型日期和时间分别为 2023-10-02 和 00:00:00z。</li>
</ul>
<h3 id="bufr_dump">bufr_dump</h3>
<p><code>bufr_dump</code> 命令可用于列出并检查 BUFR 文件的内容，包括数据本身。</p>
<p>尝试对第二个示例文件 <code>bufr-cli-ex2.bufr4</code> 运行 <code>bufr_dump</code> 命令：</p>
<div class="highlight"><pre><span></span><code>bufr_dump bufr-cli-ex2.bufr4
</code></pre></div>
<p>这将生成一个难以解析的 JSON，尝试使用 <code>-p</code> 标志以纯文本（key=value 格式）输出数据：</p>
<div class="highlight"><pre><span></span><code>bufr_dump -p bufr-cli-ex2.bufr4
</code></pre></div>
<p>你会看到大量键作为输出，其中许多是缺失的。这在实际数据中很常见，因为并非所有 eccodes 键都填充了报告数据。</p>
<p>你可以使用 <code>grep</code> 命令过滤输出，仅显示未缺失的键。例如，要显示所有未缺失的键，可以使用以下命令：</p>
<div class="highlight"><pre><span></span><code>bufr_dump -p bufr-cli-ex2.bufr4 | grep -v MISSING
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>BUFR 文件 <code>bufr-cli-ex2.bufr4</code> 中报告的海平面气压是多少？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>使用以下命令：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>bufr-cli-ex2.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;pressureReducedToMeanSeaLevel&#39;</span>
</code></pre></div>
<p>你应该看到以下输出：</p>
<p><div class="highlight"><pre><span></span><code>pressureReducedToMeanSeaLevel=105590
</code></pre></div>
这表明海平面气压为 105590 Pa（1055.90 hPa）。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>BUFR 文件 <code>bufr-cli-ex2.bufr4</code> 中报告数据的站点的 WIGOS 站点标识符是什么？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>使用以下命令：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>bufr-cli-ex2.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;wigos&#39;</span>
</code></pre></div>
<p>你应该看到以下输出：</p>
<div class="highlight"><pre><span></span><code>wigosIdentifierSeries=0
wigosIssuerOfIdentifier=20000
wigosIssueNumber=0
wigosLocalIdentifierCharacter=&quot;99100&quot;
</code></pre></div>
<p>这表明 WIGOS 站点标识符为 <code>0-20000-0-99100</code>。</p>
</details>
<h2 id="synop2bufr">synop2bufr 转换</h2>
<p>接下来，我们来看如何使用 <code>synop2bufr</code> 模块将 FM-12 SYNOP 数据转换为 BUFR 格式。<code>synop2bufr</code> 模块用于将 FM-12 SYNOP 数据转换为 BUFR 格式。该模块安装在 wis2box-api 容器中，可以通过以下命令行使用：</p>
<div class="highlight"><pre><span></span><code>synop2bufr data transform \
    --metadata &lt;station-metadata.csv&gt; \
    --output-dir &lt;output-directory-path&gt; \
    --year &lt;year-of-observation&gt; \
    --month &lt;month-of-observation&gt; \
    &lt;input-fm12.txt&gt;
</code></pre></div>
<p><code>--metadata</code> 参数用于指定站点元数据文件，该文件提供要编码到 BUFR 文件中的附加信息。
<code>--output-dir</code> 参数用于指定转换后的 BUFR 文件将写入的目录。<code>--year</code> 和 <code>--month</code> 参数用于指定观测的年份和月份。</p>
<p><code>synop2bufr</code> 模块也可以在 wis2box-webapp 中使用，通过基于 Web 的输入表单将 FM-12 SYNOP 数据转换为 BUFR 格式。</p>
<p>接下来的几个练习将演示 <code>synop2bufr</code> 模块的工作原理以及如何使用它将 FM-12 SYNOP 数据转换为 BUFR 格式。</p>
<h3 id="synop">查看示例 SYNOP 消息</h3>
<p>检查本练习的示例 SYNOP 消息文件 <code>synop_message.txt</code>：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/root/data-conversion-exercises
more<span class="w"> </span>synop_message.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>该文件中有多少条 SYNOP 报告？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>输出显示如下内容：</p>
<div class="highlight"><pre><span></span><code>AAXX 21121
15015 02999 02501 10103 21090 39765 42952 57020 60001=
15020 02997 23104 10130 21075 30177 40377 58020 60001 81041=
15090 02997 53102 10139 21075 30271 40364 58031 60001 82046=
</code></pre></div>
<p>文件中有 3 条 SYNOP 报告，分别对应 3 个不同的站点（由 5 位传统站点标识符标识：15015、15020 和 15090）。
注意，每条报告的结尾由 <code>=</code> 字符标记。</p>
</details>
<h3 id="_4">查看站点列表</h3>
<p><code>--metadata</code> 参数需要一个使用预定义格式的 CSV 文件，文件 <code>station_list.csv</code> 提供了一个工作示例：</p>
<p>使用以下命令检查 <code>station_list.csv</code> 文件的内容：</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>station_list.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>站点列表中列出了多少个站点？这些站点的 WIGOS 站点标识符是什么？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>输出显示如下内容：</p>
<div class="highlight"><pre><span></span><code>station_name,wigos_station_identifier,traditional_station_identifier,facility_type,latitude,longitude,elevation,barometer_height,territory_name,wmo_region
OCNA SUGATAG,0-20000-0-15015,15015,landFixed,47.7770616258,23.9404602638,503.0,504.0,ROU,europe
BOTOSANI,0-20000-0-15020,15020,landFixed,47.7356532437,26.6455501701,161.0,162.1,ROU,europe
</code></pre></div>
<p>这对应于 2 个站点的元数据：WIGOS 站点标识符分别为 <code>0-20000-0-15015</code> 和 <code>0-20000-0-15020</code>。</p>
</details>
<h3 id="synop-bufr">将 SYNOP 转换为 BUFR</h3>
<p>接下来，使用以下命令将 FM-12 SYNOP 消息转换为 BUFR 格式：</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>data<span class="w"> </span>transform<span class="w"> </span>--metadata<span class="w"> </span>station_list.csv<span class="w"> </span>--output-dir<span class="w"> </span>./<span class="w"> </span>--year<span class="w"> </span><span class="m">2024</span><span class="w"> </span>--month<span class="w"> </span><span class="m">09</span><span class="w"> </span>synop_message.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>创建了多少个 BUFR 文件？输出中的 WARNING 消息是什么意思？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>输出显示如下内容：</p>
<div class="highlight"><pre><span></span><code>[WARNING] Station 15090 not found in station file
</code></pre></div>
<p>如果你使用 <code>ls -lh</code> 检查目录内容，你应该会看到创建了 2 个新的 BUFR 文件：<code>WIGOS_0-20000-0-15015_20240921T120000.bufr4</code> 和 <code>WIGOS_0-20000-0-15020_20240921T120000.bufr4</code>。</p>
<p>警告消息表明，传统站点标识符为 <code>15090</code> 的站点未在站点列表文件 <code>station_list.csv</code> 中找到。这意味着该站点的 SYNOP 报告未被转换为 BUFR 格式。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>使用 <code>bufr_dump</code> 命令检查 BUFR 文件 <code>WIGOS_0-20000-0-15015_20240921T120000.bufr4</code> 的内容。</p>
<p>你能验证 <code>station_list.csv</code> 文件中提供的信息是否存在于 BUFR 文件中吗？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>你可以使用以下命令检查 BUFR 文件的内容：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-15015_20240921T120000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>MISSING
</code></pre></div>
<p>你会注意到以下输出：</p>
<div class="highlight"><pre><span></span><code>wigosIdentifierSeries=0
wigosIssuerOfIdentifier=20000
wigosIssueNumber=0
wigosLocalIdentifierCharacter=&quot;15015&quot;
blockNumber=15
stationNumber=15
stationOrSiteName=&quot;OCNA SUGATAG&quot;
stationType=1
year=2024
month=9
day=21
hour=12
minute=0
latitude=47.7771
longitude=23.9405
heightOfStationGroundAboveMeanSeaLevel=503
heightOfBarometerAboveMeanSeaLevel=504
...
</code></pre></div>
<p>注意，这包括了 <code>station_list.csv</code> 文件中提供的数据。</p>
</details>
<h3 id="wis2box-webapp-synop">wis2box-webapp 中的 SYNOP 表单</h3>
<p><code>synop2bufr</code> 模块也被用于 <code>wis2box-webapp</code>，通过基于网页的输入表单将 FM-12 SYNOP 数据转换为 BUFR 格式。<br />
要测试此功能，请访问 <code>http://YOUR-HOST/wis2box-webapp</code> 并登录。</p>
<p>从左侧菜单中选择 <code>SYNOP Form</code>，然后复制并粘贴 <code>synop_message.txt</code> 文件的内容：</p>
<div class="highlight"><pre><span></span><code>AAXX 21121
15015 02999 02501 10103 21090 39765 42952 57020 60001=
15020 02997 23104 10130 21075 30177 40377 58020 60001 81041=
15090 02997 53102 10139 21075 30271 40364 58031 60001 82046=
</code></pre></div>
<p>到 <code>SYNOP message</code> 文本区域中：</p>
<p><img alt="synop-form" src="/../assets/img/wis2box-webapp-synop-form.png" width="800"></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>你是否能够提交表单？结果是什么？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>你需要选择一个数据集并提供在前一个练习中创建的 "processes/wis2box" 的令牌以提交表单。</p>
<p>如果你提供了无效的令牌，你将看到以下结果：</p>
<ul>
<li>结果：未授权，请提供有效的 'processes/wis2box' 令牌</li>
</ul>
<p>如果你提供了有效的令牌，你将看到 "WARNINGS: 3"。点击 "WARNINGS" 打开下拉菜单，其中显示：</p>
<ul>
<li>在站点文件中未找到站点 15015</li>
<li>在站点文件中未找到站点 15020</li>
<li>在站点文件中未找到站点 15090</li>
</ul>
<p>要将这些数据转换为 BUFR 格式，你需要在你的 wis2box 中配置相应的站点，并确保这些站点与数据集的主题相关联。</p>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>在 <a href="../ingesting-data-for-publication/">ingesting-data-for-publication</a> 练习中，你导入了文件 "synop_202412030900.txt"，并通过 <code>synop2bufr</code> 模块将其转换为 BUFR 格式。</p>
<p>在 wis2box 的自动化工作流中，年份和月份会从文件名中自动提取，并用于填充 <code>--year</code> 和 <code>--month</code> 参数，而站点元数据会从 wis2box 的站点配置中自动提取。</p>
</div>
<h2 id="csv2bufr">csv2bufr 转换</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>确保你仍然登录到 <code>wis2box-api</code> 容器，并位于目录 <code>/root/data-conversion-exercises</code> 中。如果你在前一个练习中退出了容器，可以通过以下方式重新登录：</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login<span class="w"> </span>wis2box-api
<span class="nb">cd</span><span class="w"> </span>/root/data-conversion-exercises
</code></pre></div>
</div>
<p>现在我们来看如何使用 <code>csv2bufr</code> 模块将 CSV 数据转换为 BUFR 格式。该模块已安装在 <code>wis2box-api</code> 容器中，可以通过以下命令行使用：</p>
<div class="highlight"><pre><span></span><code>csv2bufr data transform \
    --bufr-template &lt;bufr-mapping-template&gt; \
    &lt;input-csv-file&gt;
</code></pre></div>
<p><code>--bufr-template</code> 参数用于指定 BUFR 映射模板文件，该文件以 JSON 格式提供输入 CSV 数据与输出 BUFR 数据之间的映射。默认映射模板安装在 <code>wis2box-api</code> 容器的目录 <code>/opt/csv2bufr/templates</code> 中。</p>
<h3 id="csv">查看示例 CSV 文件</h3>
<p>查看示例 CSV 文件 <code>aws-example.csv</code> 的内容：</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>aws-example.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>CSV 文件中有多少行数据？CSV 文件中报告的站点的 WIGOS 站点标识符是什么？</p>
</div>
<details class="question">
<summary>点击查看答案</summary>
<p>输出显示如下内容：</p>
<div class="highlight"><pre><span></span><code>wsi_series,wsi_issuer,wsi_issue_number,wsi_local,wmo_block_number,wmo_station_number,station_type,year,month,day,hour,minute,latitude,longitude,station_height_above_msl,barometer_height_above_msl,station_pressure,msl_pressure,geopotential_height,thermometer_height,air_temperature,dewpoint_temperature,relative_humidity,method_of_ground_state_measurement,ground_state,method_of_snow_depth_measurement,snow_depth,precipitation_intensity,anemometer_height,time_period_of_wind,wind_direction,wind_speed,maximum_wind_gust_direction_10_minutes,maximum_wind_gust_speed_10_minutes,maximum_wind_gust_direction_1_hour,maximum_wind_gust_speed_1_hour,maximum_wind_gust_direction_3_hours,maximum_wind_gust_speed_3_hours,rain_sensor_height,total_precipitation_1_hour,total_precipitation_3_hours,total_precipitation_6_hours,total_precipitation_12_hours,total_precipitation_24_hours
0,20000,0,60355,60,355,1,2024,3,31,1,0,47.77706163,23.94046026,503,504.43,100940,101040,1448,5,298.15,294.55,80,3,1,1,0,0.004,10,-10,30,3,30,5,40,9,20,11,2,4.7,5.3,7.9,9.5,11.4
0,20000,0,60355,60,355,1,2024,3,31,2,0,47.77706163,23.94046026,503,504.43,100940,101040,1448,5,25.,294.55,80,3,1,1,0,0.004,10,-10,30,3,30,5,40,9,20,11,2,4.7,5.3,7.9,9.5,11.4
0,20000,0,60355,60,355,1,2024,3,31,3,0,47.77706163,23.94046026,503,504.43,100940,101040,1448,5,298.15,294.55,80,3,1,1,0,0.004,10,-10,30,3,30,5,40,9,20,11,2,4.7,5.3,7.9,9.5,11.4
</code></pre></div>
<p>CSV 文件的第一行是列标题，用于标识每列中的数据。</p>
<p>在标题行之后，有 3 行数据，表示来自同一站点的 3 次气象观测，WIGOS 站点标识符为 <code>0-20000-0-60355</code>，时间戳分别为 <code>2024-03-31 01:00:00</code>、<code>2024-03-31 02:00:00</code> 和 <code>2024-03-31 03:00:00</code>。</p>
</details>
<h3 id="aws-template">查看 aws-template</h3>
<p><code>wis2box-api</code> 包含一组预定义的 BUFR 映射模板，这些模板安装在目录 <code>/opt/csv2bufr/templates</code> 中。</p>
<p>检查目录 <code>/opt/csv2bufr/templates</code> 的内容：</p>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>/opt/csv2bufr/templates
</code></pre></div>
<p>你应该看到以下输出：</p>
<div class="highlight"><pre><span></span><code>CampbellAfrica-v1-template.json  aws-template.json  daycli-template.json
</code></pre></div>
<p>让我们查看 <code>aws-template.json</code> 文件的内容：</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/opt/csv2bufr/templates/aws-template.json
</code></pre></div>
<p>这将返回一个较大的 JSON 文件，提供了 43 个 CSV 列的映射。</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>哪个 CSV 列映射到 eccodes 键 <code>airTemperature</code>？该键的有效最小值和最大值是多少？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>使用以下命令过滤输出：</p>
<p><div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/opt/csv2bufr/templates/aws-template.json<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>airTemperature
</code></pre></div>
你应该看到以下输出：</p>
<div class="highlight"><pre><span></span><code>{&quot;eccodes_key&quot;: &quot;#1#airTemperature&quot;, &quot;value&quot;: &quot;data:air_temperature&quot;, &quot;valid_min&quot;: &quot;const:193.15&quot;, &quot;valid_max&quot;: &quot;const:333.15&quot;},
</code></pre></div>
<p>对于 eccodes 键 <code>airTemperature</code>，其值将从 CSV 列 <strong>air_temperature</strong> 中的数据中提取。</p>
<p>该键的最小值和最大值分别为 <code>193.15</code> 和 <code>333.15</code>。</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>哪个 CSV 列映射到 eccodes 键 <code>internationalDataSubCategory</code>？该键的值是多少？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>使用以下命令过滤输出：</p>
<p><div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/opt/csv2bufr/templates/aws-template.json<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>internationalDataSubCategory
</code></pre></div>
你应该看到以下输出：</p>
<div class="highlight"><pre><span></span><code>{&quot;eccodes_key&quot;: &quot;internationalDataSubCategory&quot;, &quot;value&quot;: &quot;const:2&quot;},
</code></pre></div>
</details>
<p><strong>没有任何 CSV 列映射到 eccodes 键 <code>internationalDataSubCategory</code></strong>，而是使用了常量值 2，并将在使用此映射模板生成的所有 BUFR 文件中进行编码。</p>
<h3 id="csv-bufr">将 CSV 转换为 BUFR</h3>
<p>让我们尝试使用 <code>csv2bufr</code> 命令将文件转换为 BUFR 格式：</p>
<div class="highlight"><pre><span></span><code>cd /root/data-conversion-exercises
csv2bufr data transform --bufr-template aws-template ./aws-example.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>创建了多少个 BUFR 文件？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>输出显示如下内容：</p>
<div class="highlight"><pre><span></span><code>CLI:    ... Transforming ./aws-example.csv to BUFR ...
CLI:    ... Processing subsets:
CLI:    ..... 384 bytes written to ./WIGOS_0-20000-0-60355_20240331T010000.bufr4
#1#airTemperature: Value (25.0) out of valid range (193.15 - 333.15).; Element set to missing
CLI:    ..... 384 bytes written to ./WIGOS_0-20000-0-60355_20240331T020000.bufr4
CLI:    ..... 384 bytes written to ./WIGOS_0-20000-0-60355_20240331T030000.bufr4
CLI:    End of processing, exiting.
</code></pre></div>
<p>输出表明创建了 3 个 BUFR 文件：<code>WIGOS_0-20000-0-60355_20240331T010000.bufr4</code>、<code>WIGOS_0-20000-0-60355_20240331T020000.bufr4</code> 和 <code>WIGOS_0-20000-0-60355_20240331T030000.bufr4</code>。</p>
</details>
<p>要检查 BUFR 文件的内容并忽略缺失值，可以使用以下命令：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-60355_20240331T010000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>MISSING
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>在 BUFR 文件 <code>WIGOS_0-20000-0-60355_20240331T010000.bufr4</code> 中，eccodes 键 <code>airTemperature</code> 的值是多少？在 BUFR 文件 <code>WIGOS_0-20000-0-60355_20240331T020000.bufr4</code> 中又是多少？</p>
</div>
<details class="success">
<summary>点击查看答案</summary>
<p>要过滤输出，可以使用以下命令：</p>
<p><div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-60355_20240331T010000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>MISSING<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>airTemperature
</code></pre></div>
你应该会看到以下输出：</p>
<div class="highlight"><pre><span></span><code>#1#airTemperature=298.15
</code></pre></div>
<p>而对于第二个文件：</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-60355_20240331T020000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>MISSING<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>airTemperature
</code></pre></div>
<p>你不会看到任何结果，这表明在 BUFR 文件 <code>WIGOS_0-20000-0-60355_20240331T020000.bufr4</code> 中，键 <code>airTemperature</code> 的值是缺失的。<code>csv2bufr</code> 拒绝对 CSV 数据中的值 <code>25.0</code> 进行编码，因为它超出了映射模板中定义的有效范围 <code>193.15</code> 和 <code>333.15</code>。</p>
</details>
<p>请注意，使用预定义的 BUFR 映射模板将 CSV 转换为 BUFR 存在以下限制：</p>
<ul>
<li>CSV 文件必须符合映射模板中定义的格式，即 CSV 列名必须与映射模板中定义的名称匹配</li>
<li>只能编码映射模板中定义的键</li>
<li>质量控制检查仅限于映射模板中定义的检查</li>
</ul>
<p>有关如何创建和使用自定义 BUFR 映射模板的信息，请参阅下一节实践练习 <a href="../csv2bufr-templates/">csv2bufr-templates</a>。</p>
<h2 id="_5">结论</h2>
<div class="admonition success">
<p class="admonition-title">恭喜！</p>
<p>在本次实践课程中，你已经学习了：</p>
<ul>
<li>如何在 wis2box-api 容器中访问 ecCodes 命令行工具</li>
<li>如何使用 <code>synop2bufr</code> 从命令行将 FM-12 SYNOP 报告转换为 BUFR</li>
<li>如何使用 wis2box-webapp 中的 SYNOP 表单将 FM-12 SYNOP 报告转换为 BUFR</li>
<li>如何使用 <code>csv2bufr</code> 从命令行将 CSV 数据转换为 BUFR</li>
</ul>
</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 World Meteorological Organization
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.indexes", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../assets/js/disclaimer.js"></script>
      
    
  </body>
</html>