
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="WIS2 in a box (wis2box) is a Free and Open Source (FOSS) Reference Implementation of a WMO WIS2 Node. The project provides a plug and play toolset to ingest, process, and publish weather/climate/water data using standards-based approaches in alignment with the WIS2 principles. wis2box also provides access to all data in the WIS2 network. wis2box is designed to have a low barrier to entry for data providers, providing enabling infrastructure and services for data discovery, access, and visualization.">
      
      
        <meta name="author" content="World Meteorological Organization">
      
      
        <link rel="canonical" href="https://training.wis2box.wis.wmo.int/practical-sessions/data-conversion-tools/">
      
      
        <link rel="prev" href="../ingesting-data-for-publication/">
      
      
        <link rel="next" href="../csv2bufr-templates/">
      
      
      <link rel="icon" href="https://public.wmo.int/sites/all/themes/wmo/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Data Conversion Tools - WIS2 in a box training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/css/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-conversion-tools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="WIS2 in a box training" class="md-header__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../../assets/img/wmo-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WIS2 in a box training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Data Conversion Tools
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../fr/practical-sessions/data-conversion-tools/" hreflang="fr" class="md-select__link">
              Français
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../es/practical-sessions/data-conversion-tools/" hreflang="es" class="md-select__link">
              Español
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh/practical-sessions/data-conversion-tools/" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../ru/practical-sessions/data-conversion-tools/" hreflang="ru" class="md-select__link">
              Русский
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../ar/practical-sessions/data-conversion-tools/" hreflang="ar" class="md-select__link">
              العربية
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="WIS2 in a box training" class="md-nav__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../../assets/img/wmo-logo.png" alt="logo">

    </a>
    WIS2 in a box training
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Practical Sessions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Practical Sessions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connecting-to-wis2-over-mqtt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Connecting to WIS2 over MQTT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accessing-your-student-vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accessing your student VM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../initializing-wis2box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Initializing wis2box
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-wis2box-datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuring datasets in wis2box
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-station-metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuring station metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ingesting-data-for-publication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ingesting data for Publication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Data Conversion Tools
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Data Conversion Tools
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#about-fm-12-synop" class="md-nav__link">
    <span class="md-ellipsis">
      About FM-12 SYNOP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-eccodes" class="md-nav__link">
    <span class="md-ellipsis">
      About ecCodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-csv2bufr-and-synop2bufr" class="md-nav__link">
    <span class="md-ellipsis">
      About csv2bufr and synop2bufr
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Preparation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eccodes-command-line-tools" class="md-nav__link">
    <span class="md-ellipsis">
      ecCodes command-line tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ecCodes command-line tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bufr_ls" class="md-nav__link">
    <span class="md-ellipsis">
      bufr_ls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bufr_dump" class="md-nav__link">
    <span class="md-ellipsis">
      bufr_dump
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synop2bufr-conversion" class="md-nav__link">
    <span class="md-ellipsis">
      synop2bufr conversion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="synop2bufr conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#review-the-example-synop-message" class="md-nav__link">
    <span class="md-ellipsis">
      review the example SYNOP message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review-the-station-list" class="md-nav__link">
    <span class="md-ellipsis">
      review the station list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-synop-to-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      convert SYNOP to BUFR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synop-form-in-wis2box-webapp" class="md-nav__link">
    <span class="md-ellipsis">
      SYNOP Form in wis2box-webapp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csv2bufr-conversion" class="md-nav__link">
    <span class="md-ellipsis">
      csv2bufr conversion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="csv2bufr conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#review-the-example-csv-file" class="md-nav__link">
    <span class="md-ellipsis">
      review the example CSV file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review-the-aws-template" class="md-nav__link">
    <span class="md-ellipsis">
      review the aws-template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-csv-to-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      convert CSV to BUFR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../csv2bufr-templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CSV-to-BUFR mapping templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adding-gts-headers-to-wis2-notifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adding GTS headers to WIS2 notifications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets-with-access-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setting up a recommended dataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../downloading-data-from-wis2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Downloading data from WIS2 using wis2downloader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../decoding-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decoding data from WMO binary formats
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../discovering-datasets-from-wis2-gdc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discovering datasets from the WIS2 Global Discovery Catalogue
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    cheatsheets
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            cheatsheets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/wis2box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WIS2 in a box cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    csv2bufr-templates
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            csv2bufr-templates
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csv2bufr-templates/aws-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS Template
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csv2bufr-templates/daycli-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DAYCLI Template
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#about-fm-12-synop" class="md-nav__link">
    <span class="md-ellipsis">
      About FM-12 SYNOP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-eccodes" class="md-nav__link">
    <span class="md-ellipsis">
      About ecCodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-csv2bufr-and-synop2bufr" class="md-nav__link">
    <span class="md-ellipsis">
      About csv2bufr and synop2bufr
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Preparation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eccodes-command-line-tools" class="md-nav__link">
    <span class="md-ellipsis">
      ecCodes command-line tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ecCodes command-line tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bufr_ls" class="md-nav__link">
    <span class="md-ellipsis">
      bufr_ls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bufr_dump" class="md-nav__link">
    <span class="md-ellipsis">
      bufr_dump
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synop2bufr-conversion" class="md-nav__link">
    <span class="md-ellipsis">
      synop2bufr conversion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="synop2bufr conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#review-the-example-synop-message" class="md-nav__link">
    <span class="md-ellipsis">
      review the example SYNOP message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review-the-station-list" class="md-nav__link">
    <span class="md-ellipsis">
      review the station list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-synop-to-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      convert SYNOP to BUFR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synop-form-in-wis2box-webapp" class="md-nav__link">
    <span class="md-ellipsis">
      SYNOP Form in wis2box-webapp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csv2bufr-conversion" class="md-nav__link">
    <span class="md-ellipsis">
      csv2bufr conversion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="csv2bufr conversion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#review-the-example-csv-file" class="md-nav__link">
    <span class="md-ellipsis">
      review the example CSV file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review-the-aws-template" class="md-nav__link">
    <span class="md-ellipsis">
      review the aws-template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-csv-to-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      convert CSV to BUFR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="data-conversion-tools">Data Conversion Tools</h1>
<div class="admonition abstract">
<p class="admonition-title">Learning Outcomes</p>
<p>By the end of this practical session, you will be able to:</p>
<ul>
<li>Access ecCodes command-line tools within the wis2box-api container</li>
<li>Use the synop2bufr tool to convert FM-12 SYNOP reports to BUFR from the command line</li>
<li>Trigger synop2bufr conversion via the wis2box-webapp</li>
<li>Use the csv2bufr tool to convert CSV data to BUFR from the command line</li>
</ul>
</div>
<h2 id="introduction">Introduction</h2>
<p>Data published on WIS2 should meet the requirements and standards defined by the various Earth system discipline / domain expert communities.  To lower the barrier to data publication for land-based surface observations, wis2box provides tools to convert data to BUFR format. These tools are available via the wis2box-api container and can be used from the command line to test the data conversion process.</p>
<p>The main conversions currently supported by wis2box are FM-12 SYNOP reports to BUFR and CSV data to BUFR. FM-12 data is supported as it is still widely used and exchanged in the WMO community, while CSV data is supported to allow the mapping of data produced by automatic weather stations to BUFR format.</p>
<h3 id="about-fm-12-synop">About FM-12 SYNOP</h3>
<p>Surface weather reports from land surface stations have historically been reported hourly or at the main (00, 06, 12, and 18 UTC) and intermediate (03, 09, 15, 21 UTC) synoptic hours. Prior to the migration to BUFR, these reports were encoded in the plain text FM-12 SYNOP code form. While the migration to BUFR was scheduled to be complete by 2012, a large number of reports are still exchanged in the legacy FM-12 SYNOP format. Further information on the FM-12 SYNOP format can be found in the WMO Manual on Codes, Volume I.1 (WMO-No. 306, Volume I.1).</p>
<h3 id="about-eccodes">About ecCodes</h3>
<p>The ecCodes library is a set of software libraries and utilities designed to decode and encode meteorological data in the GRIB and BUFR formats. It is developed by the European Centre for Medium-Range Weather Forecasts (ECMWF), see the <a href="https://confluence.ecmwf.int/display/ECC/ecCodes+documentation">ecCodes documentation</a> for more information.</p>
<p>The wis2box software includes the ecCodes library in the base image of the wis2box-api container. This allows users to access the command-line tools and libraries from within the container. The ecCodes library is used within the wis2box-stack to decode and encode BUFR messages.</p>
<h3 id="about-csv2bufr-and-synop2bufr">About csv2bufr and synop2bufr</h3>
<p>In addition to ecCodes, the wis2box uses the following Python modules that work with ecCodes to convert data to BUFR format:</p>
<ul>
<li><strong>synop2bufr</strong>: to support the legacy FM-12 SYNOP format traditionally used by manual observers. The synop2bufr module relies on additional station metadata to encode additional parameters in the BUFR file. See the <a href="https://github.com/World-Meteorological-Organization/synop2bufr">synop2bufr repository at GitHub</a></li>
<li><strong>csv2bufr</strong>: to enable the conversion of CSV-extract produced by automated weather stations to BUFR format. The csv2bufr module is used to convert CSV data to BUFR format using a mapping template that defines how the CSV data should be mapped to the BUFR format. See the <a href="https://github.com/World-Meteorological-Organization/csv2bufr">csv2bufr repository at GitHub</a></li>
</ul>
<p>These modules can be used standalone or as part of the wis2box stack. </p>
<h2 id="preparation">Preparation</h2>
<div class="admonition warning">
<p class="admonition-title">Prerequisites</p>
<ul>
<li>Ensure that your wis2box has been configured and started</li>
<li>Ensure you have set up a dataset and configured at least one station in your wis2box</li>
<li>Connect to the MQTT broker of your wis2box instance using MQTT Explorer</li>
<li>Open the wis2box web application (<code>http://YOUR-HOST/wis2box-webapp</code>) and ensure you are logged in</li>
<li>Open the Grafana dashboard for your instance by going to <code>http://YOUR-HOST:3000</code></li>
</ul>
</div>
<p>To use the BUFR command-line tools, you will need to be logged in to the wis2box-api container. Unless specified otherwise, all commands should be run on this container. You will also need to have MQTT Explorer open and connected to your broker.</p>
<p>First, connect to your student VM via your SSH client and copy the exercise materials to the wis2box-api container:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>~/exercise-materials/data-conversion-exercises<span class="w"> </span>wis2box-api:/root
</code></pre></div>
<p>Then log in to the wis2box-api container and change to the directory where the exercise materials are located:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login<span class="w"> </span>wis2box-api
<span class="nb">cd</span><span class="w"> </span>/root/data-conversion-exercises
</code></pre></div>
<p>Confirm that the tools are available, starting with ecCodes:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-V
</code></pre></div>
<p>You should get the following response:</p>
<div class="highlight"><pre><span></span><code>ecCodes Version 2.36.0
</code></pre></div>
<p>Next, check the synop2bufr version:</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>--version
</code></pre></div>
<p>You should get the following response:</p>
<div class="highlight"><pre><span></span><code>synop2bufr, version 0.7.0
</code></pre></div>
<p>Next, check csv2bufr:</p>
<div class="highlight"><pre><span></span><code>csv2bufr<span class="w"> </span>--version
</code></pre></div>
<p>You should get the following response:</p>
<div class="highlight"><pre><span></span><code>csv2bufr, version 0.8.6
</code></pre></div>
<h2 id="eccodes-command-line-tools">ecCodes command-line tools</h2>
<p>The ecCodes library included in the wis2box-api container provides a number of command-line tools for working with BUFR files. 
The next exercises demonstrate how to use <code>bufr_ls</code> and <code>bufr_dump</code> to check the content of a BUFR file.</p>
<h3 id="bufr_ls">bufr_ls</h3>
<p>In this first exercise, you will use the <code>bufr_ls</code> command to inspect the headers of a BUFR file and determine the type of the contents of the file.</p>
<p>Use the following command to run <code>bufr_ls</code> on the file <code>bufr-cli-ex1.bufr4</code>:</p>
<div class="highlight"><pre><span></span><code>bufr_ls<span class="w"> </span>bufr-cli-ex1.bufr4
</code></pre></div>
<p>You should see the following output:</p>
<div class="highlight"><pre><span></span><code>bufr-cli-ex1.bufr4
centre<span class="w">                     </span>masterTablesVersionNumber<span class="w">  </span>localTablesVersionNumber<span class="w">   </span>typicalDate<span class="w">                </span>typicalTime<span class="w">                </span>numberOfSubsets
cnmc<span class="w">                       </span><span class="m">29</span><span class="w">                         </span><span class="m">0</span><span class="w">                          </span><span class="m">20231002</span><span class="w">                   </span><span class="m">000000</span><span class="w">                     </span><span class="m">1</span>
<span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>messages<span class="w"> </span><span class="k">in</span><span class="w"> </span>bufr-cli-ex1.bufr4

<span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>total<span class="w"> </span>messages<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>file
</code></pre></div>
<p>Various options can be passed to <code>bufr_ls</code> to change both the format and header fields printed.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What would be the command to list the previous output in JSON format?</p>
<p>You can run the command <code>bufr_ls</code> with the <code>-h</code> flag to see the available options.</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>You can change the output format to JSON using the <code>-j</code> flag, i.e.
<div class="highlight"><pre><span></span><code>bufr_ls<span class="w"> </span>-j<span class="w"> </span>bufr-cli-ex1.bufr4
</code></pre></div></p>
<p>When run, this should give you the following output:
<div class="highlight"><pre><span></span><code>{ &quot;messages&quot; : [
  {
    &quot;centre&quot;: &quot;cnmc&quot;,
    &quot;masterTablesVersionNumber&quot;: 29,
    &quot;localTablesVersionNumber&quot;: 0,
    &quot;typicalDate&quot;: 20231002,
    &quot;typicalTime&quot;: &quot;000000&quot;,
    &quot;numberOfSubsets&quot;: 1
  }
]}
</code></pre></div></p>
</details>
<p>The output printed represents the values of some of the header keys in the BUFR file.</p>
<p>On its own, this information is not very informative, with only limited information on the file contents provided.</p>
<p>When examining a BUFR file, we often want to determine the type of data contained in the file and the typical date/time of the data in the file. This information can be listed using the <code>-p</code> flag to select the headers to output. Multiple headers can be included using a comma-separated list.</p>
<p>You can use the following command to list the data category, sub-category, typical date, and time:</p>
<div class="highlight"><pre><span></span><code>bufr_ls<span class="w"> </span>-p<span class="w"> </span>dataCategory,internationalDataSubCategory,typicalDate,typicalTime<span class="w"> </span>-j<span class="w"> </span>bufr-cli-ex1.bufr4
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Execute the previous command and interpret the output using <a href="https://github.com/wmo-im/CCT/blob/master/C13.csv">Common Code Table C-13</a> to determine the data category and sub-category.</p>
<p>What type of data (data category and sub-category) is contained in the file? What is the typical date and time for the data?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<div class="highlight"><pre><span></span><code>{ &quot;messages&quot; : [
  {
    &quot;dataCategory&quot;: 2,
    &quot;internationalDataSubCategory&quot;: 4,
    &quot;typicalDate&quot;: 20231002,
    &quot;typicalTime&quot;: &quot;000000&quot;
  }
]}
</code></pre></div>
<p>From this, we see that:</p>
<ul>
<li>The data category is 2, indicating <strong>"Vertical soundings (other than satellite)"</strong> data.</li>
<li>The international sub-category is 4, indicating <strong>"Upper-level temperature/humidity/wind reports from fixed-land stations (TEMP)"</strong> data.</li>
<li>The typical date and time are 2023-10-02 and 00:00:00z, respectively.</li>
</ul>
</details>
<h3 id="bufr_dump">bufr_dump</h3>
<p>The <code>bufr_dump</code> command can be used to list and examine the contents of a BUFR file, including the data itself.</p>
<p>Try to run the <code>bufr_dump</code> command on the second example file <code>bufr-cli-ex2.bufr4</code>:</p>
<div class="highlight"><pre><span></span><code>bufr_dump bufr-cli-ex2.bufr4
</code></pre></div>
<p>This results a JSON that can be hard to parse, try using the <code>-p</code> flag to output the data in plain text (key=value format):</p>
<div class="highlight"><pre><span></span><code>bufr_dump -p bufr-cli-ex2.bufr4
</code></pre></div>
<p>You should will see a large number of keys as output, many of which are missing. This is typical with real world data as not all the eccodes keys are populated with reported data.</p>
<p>You can use the <code>grep</code> command to filter the output and only show the keys that are not missing. For example, to show all the keys that are not missing, you can use the following command:</p>
<div class="highlight"><pre><span></span><code>bufr_dump -p bufr-cli-ex2.bufr4 | grep -v MISSING
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What is the pressured reduced to mean sea level reported in the BUFR file <code>bufr-cli-ex2.bufr4</code>?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>Using the following command:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>bufr-cli-ex2.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;pressureReducedToMeanSeaLevel&#39;</span>
</code></pre></div>
<p>You should see the following output:</p>
<p><div class="highlight"><pre><span></span><code>pressureReducedToMeanSeaLevel=105590
</code></pre></div>
This indicates that the pressure reduced to mean sea level is 105590 Pa (1055.90 hPa).</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What is the WIGOS station identifier of the station that reported the data in the BUFR file <code>bufr-cli-ex2.bufr4</code>?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>Using the following command:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>bufr-cli-ex2.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;wigos&#39;</span>
</code></pre></div>
<p>You should see the following output:</p>
<div class="highlight"><pre><span></span><code>wigosIdentifierSeries=0
wigosIssuerOfIdentifier=20000
wigosIssueNumber=0
wigosLocalIdentifierCharacter=&quot;99100&quot;
</code></pre></div>
<p>This indicates that the WIGOS station identifier is <code>0-20000-0-99100</code>.</p>
</details>
<h2 id="synop2bufr-conversion">synop2bufr conversion</h2>
<p>Next, let's look at how to convert FM-12 SYNOP data to BUFR format using the <code>synop2bufr</code> module. The <code>synop2bufr</code> module is used to convert FM-12 SYNOP data to BUFR format.  The module is installed in the wis2box-api container and can be used from the command line as follows:</p>
<div class="highlight"><pre><span></span><code>synop2bufr data transform \
    --metadata &lt;station-metadata.csv&gt; \
    --output-dir &lt;output-directory-path&gt; \
    --year &lt;year-of-observation&gt; \
    --month &lt;month-of-observation&gt; \
    &lt;input-fm12.txt&gt;
</code></pre></div>
<p>The <code>--metadata</code> argument is used to specify the station metadata file, that provide additional information to be encoded in the BUFR file.
The <code>--output-dir</code> argument is used to specify the directory where the converted BUFR files will be written. The <code>--year</code> and <code>--month</code> arguments are used to specify the year and month of the observation.</p>
<p>The <code>synop2bufr</code> module is also used in the wis2box-webapp to convert FM-12 SYNOP data to BUFR format using a web-based input form.</p>
<p>The next few exercises will demonstrate how the <code>synop2bufr</code>-module works and how to use it to convert FM-12 SYNOP data to BUFR format.</p>
<h3 id="review-the-example-synop-message">review the example SYNOP message</h3>
<p>Inspect the example SYNOP message file for this exercise <code>synop_message.txt</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>/root/data-conversion-exercises
more<span class="w"> </span>synop_message.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many SYNOP reports are in this file?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>The output shows the following:</p>
<div class="highlight"><pre><span></span><code>AAXX 21121
15015 02999 02501 10103 21090 39765 42952 57020 60001=
15020 02997 23104 10130 21075 30177 40377 58020 60001 81041=
15090 02997 53102 10139 21075 30271 40364 58031 60001 82046=
</code></pre></div>
<p>There are 3 SYNOP reports in the file, corresponding to 3 different stations (identified by the 5-digit traditional station identifiers: 15015, 15020, and 15090).
Note that the end of each report is marked by the <code>=</code> character. </p>
</details>
<h3 id="review-the-station-list">review the station list</h3>
<p>The <code>--metadata</code> argument requires a CSV file using a pre-defined format, a working example is provided in the file <code>station_list.csv</code>:</p>
<p>Use the following command to inspect the contents of the <code>station_list.csv</code> file:</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>station_list.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many stations are listed in the station list? What are the WIGOS station identifiers of the stations?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>The output shows the following:</p>
<div class="highlight"><pre><span></span><code>station_name,wigos_station_identifier,traditional_station_identifier,facility_type,latitude,longitude,elevation,barometer_height,territory_name,wmo_region
OCNA SUGATAG,0-20000-0-15015,15015,landFixed,47.7770616258,23.9404602638,503.0,504.0,ROU,europe
BOTOSANI,0-20000-0-15020,15020,landFixed,47.7356532437,26.6455501701,161.0,162.1,ROU,europe
</code></pre></div>
<p>This corresponds to the station metadata for 2 stations: for the WIGOS station identifiers <code>0-20000-0-15015</code> and <code>0-20000-0-15020</code>.</p>
</details>
<h3 id="convert-synop-to-bufr">convert SYNOP to BUFR</h3>
<p>Next, use the following command to convert the FM-12 SYNOP message to BUFR format:</p>
<div class="highlight"><pre><span></span><code>synop2bufr<span class="w"> </span>data<span class="w"> </span>transform<span class="w"> </span>--metadata<span class="w"> </span>station_list.csv<span class="w"> </span>--output-dir<span class="w"> </span>./<span class="w"> </span>--year<span class="w"> </span><span class="m">2024</span><span class="w"> </span>--month<span class="w"> </span><span class="m">09</span><span class="w"> </span>synop_message.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many BUFR files were created ? What does the WARNING message in the output mean?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>The output shows the following:</p>
<div class="highlight"><pre><span></span><code>[WARNING] Station 15090 not found in station file
</code></pre></div>
<p>If you check the content of your directory with the <code>ls -lh</code>, you should see 2 new BUFR files were created: <code>WIGOS_0-20000-0-15015_20240921T120000.bufr4</code> and <code>WIGOS_0-20000-0-15020_20240921T120000.bufr4</code>.</p>
<p>The warning message indicates that the station with the traditional station identifier <code>15090</code> was not found in the station list file <code>station_list.csv</code>. This means that the SYNOP report for this station was not converted to BUFR format.</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Check the content of the BUFR file <code>WIGOS_0-20000-0-15015_20240921T120000.bufr4</code> using the <code>bufr_dump</code> command. </p>
<p>Can you verify the information provided in the <code>station_list.csv</code> file is present in the BUFR file?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>You can use the following command to check the content of the BUFR file:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-15015_20240921T120000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>MISSING
</code></pre></div>
<p>You will note the following output:</p>
<div class="highlight"><pre><span></span><code>wigosIdentifierSeries=0
wigosIssuerOfIdentifier=20000
wigosIssueNumber=0
wigosLocalIdentifierCharacter=&quot;15015&quot;
blockNumber=15
stationNumber=15
stationOrSiteName=&quot;OCNA SUGATAG&quot;
stationType=1
year=2024
month=9
day=21
hour=12
minute=0
latitude=47.7771
longitude=23.9405
heightOfStationGroundAboveMeanSeaLevel=503
heightOfBarometerAboveMeanSeaLevel=504
...
</code></pre></div>
<p>Note that this includes the data provided by the <code>station_list.csv</code> file.</p>
</details>
<h3 id="synop-form-in-wis2box-webapp">SYNOP Form in wis2box-webapp</h3>
<p>The <code>synop2bufr</code> module is also used in the wis2box-webapp to convert FM-12 SYNOP data to BUFR format using a web-based input form.
To test this, go to the <code>http://YOUR-HOST/wis2box-webapp</code> and log in.</p>
<p>Select the <code>SYNOP Form</code> from the menu on the left and copy paste the contents of the <code>synop_message.txt</code> file:</p>
<div class="highlight"><pre><span></span><code>AAXX 21121
15015 02999 02501 10103 21090 39765 42952 57020 60001=
15020 02997 23104 10130 21075 30177 40377 58020 60001 81041=
15090 02997 53102 10139 21075 30271 40364 58031 60001 82046=
</code></pre></div>
<p>Into the <code>SYNOP message</code> text area:</p>
<p><img alt="synop-form" src="/../assets/img/wis2box-webapp-synop-form.png" width="800"></p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Are you able to submit the form? What is the result?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>You need to select a dataset and provide the token for "processes/wis2box" you created in the previous exercise to submit the form.</p>
<p>If you provide an invalid token, you will see:</p>
<ul>
<li>Result: Unauthorized, please provide a valid 'processes/wis2box' token</li>
</ul>
<p>If you provide a valid token, you will see "WARNINGS: 3". Click on the "WARNINGS" to open the dropdown which will show:</p>
<ul>
<li>Station 15015 not found in station file</li>
<li>Station 15020 not found in station file</li>
<li>Station 15090 not found in station file</li>
</ul>
<p>To convert this data to BUFR format you would need to configure the corresponding stations in your wis2box and ensure that the stations are associated to the topic for your dataset.</p>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the exercise for <a href="../ingesting-data-for-publication/">ingesting-data-for-publication</a> you ingested the file "synop_202412030900.txt" and it was converted to BUFR format by the synop2bufr module.</p>
<p>In the automated workflow in the wis2box, the year and month are automatically extracted from the filename and used to populate the <code>--year</code> and <code>--month</code> arguments required by synop2bufr, while the station metadata is automatically extracted from the station configuration in the wis2box.</p>
</div>
<h2 id="csv2bufr-conversion">csv2bufr conversion</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure you are still logged in the wis2box-api container and in the directory <code>/root/data-conversion-exercises</code>, if you exited the container in the previous exercise, you can log in again as follows:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login<span class="w"> </span>wis2box-api
<span class="nb">cd</span><span class="w"> </span>/root/data-conversion-exercises
</code></pre></div>
</div>
<p>Now let's look at how the convert CSV data to BUFR format using the <code>csv2bufr</code> module. The module is installed in the wis2box-api container and can be used from the command line as follows:</p>
<div class="highlight"><pre><span></span><code>csv2bufr data transform \
    --bufr-template &lt;bufr-mapping-template&gt; \
    &lt;input-csv-file&gt;
</code></pre></div>
<p>The <code>--bufr-template</code> argument is used to specify the BUFR mapping template file, which provides mapping between the input CSV data and the output BUFR data is specified in a JSON file. Default mapping templates are installed in the directory <code>/opt/csv2bufr/templates</code> in the wis2box-api container.</p>
<h3 id="review-the-example-csv-file">review the example CSV file</h3>
<p>Review the content of the example CSV file <code>aws-example.csv</code>:</p>
<div class="highlight"><pre><span></span><code>more<span class="w"> </span>aws-example.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many rows of data are in the CSV file? What is the WIGOS station identifier of the stations reporting in the CSV file?</p>
</div>
<details class="question">
<summary>Click to reveal answer</summary>
<p>The output shows the following:</p>
<div class="highlight"><pre><span></span><code>wsi_series,wsi_issuer,wsi_issue_number,wsi_local,wmo_block_number,wmo_station_number,station_type,year,month,day,hour,minute,latitude,longitude,station_height_above_msl,barometer_height_above_msl,station_pressure,msl_pressure,geopotential_height,thermometer_height,air_temperature,dewpoint_temperature,relative_humidity,method_of_ground_state_measurement,ground_state,method_of_snow_depth_measurement,snow_depth,precipitation_intensity,anemometer_height,time_period_of_wind,wind_direction,wind_speed,maximum_wind_gust_direction_10_minutes,maximum_wind_gust_speed_10_minutes,maximum_wind_gust_direction_1_hour,maximum_wind_gust_speed_1_hour,maximum_wind_gust_direction_3_hours,maximum_wind_gust_speed_3_hours,rain_sensor_height,total_precipitation_1_hour,total_precipitation_3_hours,total_precipitation_6_hours,total_precipitation_12_hours,total_precipitation_24_hours
0,20000,0,60355,60,355,1,2024,3,31,1,0,47.77706163,23.94046026,503,504.43,100940,101040,1448,5,298.15,294.55,80,3,1,1,0,0.004,10,-10,30,3,30,5,40,9,20,11,2,4.7,5.3,7.9,9.5,11.4
0,20000,0,60355,60,355,1,2024,3,31,2,0,47.77706163,23.94046026,503,504.43,100940,101040,1448,5,25.,294.55,80,3,1,1,0,0.004,10,-10,30,3,30,5,40,9,20,11,2,4.7,5.3,7.9,9.5,11.4
0,20000,0,60355,60,355,1,2024,3,31,3,0,47.77706163,23.94046026,503,504.43,100940,101040,1448,5,298.15,294.55,80,3,1,1,0,0.004,10,-10,30,3,30,5,40,9,20,11,2,4.7,5.3,7.9,9.5,11.4
</code></pre></div>
<p>The first row of the CSV file contains the column headers, which are used to identify the data in each column.</p>
<p>After the header row, there are 3 rows of data, representing 3 weather observation from the same station with WIGOS station identifier <code>0-20000-0-60355</code> at three different timestamps <code>2024-03-31 01:00:00</code>, <code>2024-03-31 02:00:00</code>, and <code>2024-03-31 03:00:00</code>.</p>
</details>
<h3 id="review-the-aws-template">review the aws-template</h3>
<p>The wis2box-api includes a set of predefined BUFR mapping templates that are installed in the directory <code>/opt/csv2bufr/templates</code>.</p>
<p>Check the content of the directory <code>/opt/csv2bufr/templates</code>:</p>
<p><div class="highlight"><pre><span></span><code>ls<span class="w"> </span>/opt/csv2bufr/templates
</code></pre></div>
You should see the following output:</p>
<div class="highlight"><pre><span></span><code>CampbellAfrica-v1-template.json  aws-template.json  daycli-template.json
</code></pre></div>
<p>Let's check the content of the <code>aws-template.json</code> file:</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/opt/csv2bufr/templates/aws-template.json
</code></pre></div>
<p>This returns a large JSON file, providing the mapping for 43 CSV columns.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What CSV column is mapped to the eccodes key <code>airTemperature</code>? What are the valid minimum and maximum values for this key?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>Using the following command to filter the output:</p>
<p><div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/opt/csv2bufr/templates/aws-template.json<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>airTemperature
</code></pre></div>
You should see the following output:</p>
<div class="highlight"><pre><span></span><code>{&quot;eccodes_key&quot;: &quot;#1#airTemperature&quot;, &quot;value&quot;: &quot;data:air_temperature&quot;, &quot;valid_min&quot;: &quot;const:193.15&quot;, &quot;valid_max&quot;: &quot;const:333.15&quot;},
</code></pre></div>
<p>The value that will be encoded for the eccodes key <code>airTemperature</code> will be taken from the data in the CSV column: <strong>air_temperature</strong>.</p>
<p>The minimum and maximum values for this key are <code>193.15</code> and <code>333.15</code>, respectively.</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What CSV column is mapped to the eccodes key <code>internationalDataSubCategory</code>? What is the value of this key?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>Using the following command to filter the output:</p>
<p><div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/opt/csv2bufr/templates/aws-template.json<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>internationalDataSubCategory
</code></pre></div>
You should see the following output:</p>
<div class="highlight"><pre><span></span><code>{&quot;eccodes_key&quot;: &quot;internationalDataSubCategory&quot;, &quot;value&quot;: &quot;const:2&quot;},
</code></pre></div>
<p><strong>There is no CSV column mapped to the eccodes key <code>internationalDataSubCategory</code></strong>, instead the constant value 2 is used and will be encoded in all BUFR files produced with this mapping template.</p>
</details>
<h3 id="convert-csv-to-bufr">convert CSV to BUFR</h3>
<p>Let's attempt to convert the file to BUFR format using the <code>csv2bufr</code> command:</p>
<div class="highlight"><pre><span></span><code>cd /root/data-conversion-exercises
csv2bufr data transform --bufr-template aws-template ./aws-example.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many BUFR files were created?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>The output shows the following:</p>
<div class="highlight"><pre><span></span><code>CLI:    ... Transforming ./aws-example.csv to BUFR ...
CLI:    ... Processing subsets:
CLI:    ..... 384 bytes written to ./WIGOS_0-20000-0-60355_20240331T010000.bufr4
#1#airTemperature: Value (25.0) out of valid range (193.15 - 333.15).; Element set to missing
CLI:    ..... 384 bytes written to ./WIGOS_0-20000-0-60355_20240331T020000.bufr4
CLI:    ..... 384 bytes written to ./WIGOS_0-20000-0-60355_20240331T030000.bufr4
CLI:    End of processing, exiting.
</code></pre></div>
<p>The output indicates that 3 BUFR files were created: <code>WIGOS_0-20000-0-60355_20240331T010000.bufr4</code>, <code>WIGOS_0-20000-0-60355_20240331T020000.bufr4</code>, and <code>WIGOS_0-20000-0-60355_20240331T030000.bufr4</code>.</p>
</details>
<p>To check the content of the BUFR files while ignoring the missing values, you can use the following command:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-60355_20240331T010000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>MISSING
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>What is the value of the eccodes key <code>airTemperature</code> in the BUFR file <code>WIGOS_0-20000-0-60355_20240331T010000.bufr4</code>? How about in the BUFR file <code>WIGOS_0-20000-0-60355_20240331T020000.bufr4</code>?</p>
</div>
<details class="success">
<summary>Click to reveal answer</summary>
<p>To filter the output, you can use the following command:</p>
<p><div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-60355_20240331T010000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>MISSING<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>airTemperature
</code></pre></div>
You should see the following output:</p>
<div class="highlight"><pre><span></span><code>#1#airTemperature=298.15
</code></pre></div>
<p>While for the second file:</p>
<div class="highlight"><pre><span></span><code>bufr_dump<span class="w"> </span>-p<span class="w"> </span>WIGOS_0-20000-0-60355_20240331T020000.bufr4<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>MISSING<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>airTemperature
</code></pre></div>
<p>You get no result, indicating that the value for the key <code>airTemperature</code> is missing in the BUFR file <code>WIGOS_0-20000-0-60355_20240331T020000.bufr4</code>. The csv2bufr refused to encode the value <code>25.0</code> from the CSV-data as it is outside the valid range of <code>193.15</code> and <code>333.15</code> as defined in the mapping template.</p>
</details>
<p>Note that converting CSV to BUFR using one of the predefined BUFR mapping template has limitations:</p>
<ul>
<li>the CSV file must be in the format defined in the mapping template, i.e. the CSV column names must match the names defined in the mapping template</li>
<li>you can only encode the keys defined in the mapping template</li>
<li>the quality control checks are limited to the checks defined in the mapping template</li>
</ul>
<p>For information on how to create and use custom BUFR-mapping-templates see the next practical exercise <a href="../csv2bufr-templates/">csv2bufr-templates</a>.</p>
<h2 id="conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Congratulations!</p>
<p>In this practical session you have learned:</p>
<ul>
<li>how to access ecCodes command-line tools within the wis2box-api container</li>
<li>how to use <code>synop2bufr</code> to convert FM-12 SYNOP reports to BUFR from the command line</li>
<li>how to use the SYNOP Form in the wis2box-webapp to convert FM-12 SYNOP reports to BUFR</li>
<li>how to use <code>csv2bufr</code> to convert CSV data to BUFR from the command line</li>
</ul>
</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 World Meteorological Organization
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../assets/js/disclaimer.js"></script>
      
    
  </body>
</html>